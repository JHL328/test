{"title": "Neural Models for Documents with Metadata", "abstract": "Most real-world document collections involve various types of metadata, such as author, source, and date, and yet the most commonly-used approaches to modeling text corpora ignore this information. While specialized models have been developed for particular applications, few are widely used in practice, as customization typically requires derivation of a custom inference algorithm. In this paper, we build on recent advances in variational inference methods and propose a general neural framework, based on topic models, to enable flexible incorporation of metadata and allow for rapid exploration of alternative models. Our approach achieves strong performance, with a manageable tradeoff between perplexity, coherence, and sparsity. Finally, we demonstrate the potential of our framework through an exploration of a corpus of articles about US immigration.", "text": [{"id": 0, "string": "Introduction Topic models comprise a family of methods for uncovering latent structure in text corpora, and are widely used tools in the digital humanities, political science, and other related fields (Boyd-Graber et al., 2017) ."}, {"id": 1, "string": "Latent Dirichlet allocation (LDA; Blei et al., 2003) is often used when there is no prior knowledge about a corpus."}, {"id": 2, "string": "In the real world, however, most documents have non-textual attributes such as author (Rosen-Zvi et al., 2004) , timestamp , rating (McAuliffe and Blei, 2008) , or ideology (Eisenstein et al., 2011; Nguyen et al., 2015b) , which we refer to as metadata."}, {"id": 3, "string": "Many customizations of LDA have been developed to incorporate document metadata."}, {"id": 4, "string": "Two models of note are supervised LDA (SLDA; McAuliffe and Blei, 2008) , which jointly models words and labels (e.g., ratings) as being generated from a latent representation, and sparse additive generative models (SAGE; Eisenstein et al., 2011) , which assumes that observed covariates (e.g., author ideology) have a sparse effect on the relative probabilities of words given topics."}, {"id": 5, "string": "The structural topic model (STM; Roberts et al., 2014) , which adds correlations between topics to SAGE, is also widely used, but like SAGE it is limited in the types of metadata it can efficiently make use of, and how that metadata is used."}, {"id": 6, "string": "Note that in this work we will distinguish labels (metadata that are generated jointly with words from latent topic representations) from covariates (observed metadata that influence the distribution of labels and words)."}, {"id": 7, "string": "The ability to create variations of LDA such as those listed above has been limited by the expertise needed to develop custom inference algorithms for each model."}, {"id": 8, "string": "As a result, it is rare to see such variations being widely used in practice."}, {"id": 9, "string": "In this work, we take advantage of recent advances in variational methods (Kingma and Welling, 2014; Rezende et al., 2014; Miao et al., 2016; Srivastava and Sutton, 2017) to facilitate approximate Bayesian inference without requiring model-specific derivations, and propose a general neural framework for topic models with metadata, SCHOLAR."}, {"id": 10, "string": "1 SCHOLAR combines the abilities of SAGE and SLDA, and allows for easy exploration of the following options for customization: 1."}, {"id": 11, "string": "Covariates: as in SAGE and STM, we incorporate explicit deviations for observed covariates, as well as effects for interactions with topics."}, {"id": 12, "string": "2."}, {"id": 13, "string": "Supervision: as in SLDA, we can use metadata as labels to help infer topics that are relevant in predicting those labels."}, {"id": 14, "string": "3."}, {"id": 15, "string": "Rich encoder network: we use the encoding network of a variational autoencoder (VAE) to incorporate additional prior knowledge in the form of word embeddings, and/or to provide interpretable embeddings of covariates."}, {"id": 16, "string": "4."}, {"id": 17, "string": "Sparsity: as in SAGE, a sparsity-inducing prior can be used to encourage more interpretable topics, represented as sparse deviations from a background log-frequency."}, {"id": 18, "string": "We begin with the necessary background and motivation ( \u00a72), and then describe our basic framework and its extensions ( \u00a73), followed by a series of experiments ( \u00a74)."}, {"id": 19, "string": "In an unsupervised setting, we can customize the model to trade off between perplexity, coherence, and sparsity, with improved coherence through the introduction of word vectors."}, {"id": 20, "string": "Alternatively, by incorporating metadata we can either learn topics that are more predictive of labels than SLDA, or learn explicit deviations for particular parts of the metadata."}, {"id": 21, "string": "Finally, by combining all parts of our model we can meaningfully incorporate metadata in multiple ways, which we demonstrate through an exploration of a corpus of news articles about US immigration."}, {"id": 22, "string": "In presenting this particular model, we emphasize not only its ability to adapt to the characteristics of the data, but the extent to which the VAE approach to inference provides a powerful framework for latent variable modeling that suggests the possibility of many further extensions."}, {"id": 23, "string": "Our implementation is available at https://github."}, {"id": 24, "string": "com/dallascard/scholar."}, {"id": 25, "string": "Background and Motivation LDA can be understood as a non-negative Bayesian matrix factorization model: the observed document-word frequency matrix, X \u2208 Z D\u00d7V (D is the number of documents, V is the vocabulary size) is factored into two low-rank matrices, \u0398 D\u00d7K and B K\u00d7V , where each row of \u0398, \u03b8 i \u2208 \u2206 K is a latent variable representing a distribution over topics in document i, and each row of B, \u03b2 k \u2208 \u2206 V , represents a single topic, i.e., a distribution over words in the vocabulary."}, {"id": 26, "string": "2 While it is possible to factor the count data into unconstrained 2 Z denotes nonnegative integers, and \u2206 K denotes the set of K-length nonnegative vectors that sum to one."}, {"id": 27, "string": "For a proper probabilistic interpretation, the matrix to be factored is actually the matrix of latent mean parameters of the assumed data generating process, Xij \u223c Poisson(\u039bij)."}, {"id": 28, "string": "See Cemgil (2009) or Paisley et al."}, {"id": 29, "string": "(2014) for details."}, {"id": 30, "string": "matrices, the particular priors assumed by LDA are important for interpretability (Wallach et al., 2009) ."}, {"id": 31, "string": "For example, the neural variational document model (NVDM; Miao et al., 2016) allows \u03b8 i \u2208 R K and achieves normalization by taking the softmax of \u03b8 i B."}, {"id": 32, "string": "However, the experiments in Srivastava and Sutton (2017) found the performance of the NVDM to be slightly worse than LDA in terms of perplexity, and dramatically worse in terms of topic coherence."}, {"id": 33, "string": "The topics discovered by LDA tend to be parsimonious and coherent groupings of words which are readily identifiable to humans as being related to each other (Chang et al., 2009) , and the resulting mode of the matrix \u0398 provides a representation of each document which can be treated as a measurement for downstream tasks, such as classification or answering social scientific questions (Wallach, 2016) ."}, {"id": 34, "string": "LDA does not require -and cannot make use of -additional prior knowledge."}, {"id": 35, "string": "As such, the topics that are discovered may bear little connection to metadata of a corpus that is of interest to a researcher, such as sentiment, ideology, or time."}, {"id": 36, "string": "In this paper, we take inspiration from two models which have sought to alleviate this problem."}, {"id": 37, "string": "The first, supervised LDA (SLDA; McAuliffe and Blei, 2008) , assumes that documents have labels y which are generated conditional on the corresponding latent representation, i.e., y i \u223c p(y | \u03b8 i )."}, {"id": 38, "string": "3 By incorporating labels into the model, it is forced to learn topics which allow documents to be represented in a way that is useful for the classification task."}, {"id": 39, "string": "Such models can be used inductively as text classifiers (Balasubramanyan et al., 2012) ."}, {"id": 40, "string": "SAGE (Eisenstein et al., 2011) , by contrast, is an exponential-family model, where the key innovation was to replace topics with sparse deviations from the background log-frequency of words (d), i.e., p(word | softmax(d + \u03b8 i B))."}, {"id": 41, "string": "SAGE can also incorporate deviations for observed covariates, as well as interactions between topics and covariates, by including additional terms inside the softmax."}, {"id": 42, "string": "In principle, this allows for inferring, for example, the effect on an author's ideology on their choice of words, as well as ideological variations on each underlying topic."}, {"id": 43, "string": "Unlike the NVDM, SAGE still constrains \u03b8 i to lie on the simplex, as in LDA."}, {"id": 44, "string": "SLDA and SAGE provide two different ways that users might wish to incorporate prior knowl-edge as a way of guiding the discovery of topics in a corpus: SLDA incorporates labels through a distribution conditional on topics; SAGE includes explicit sparse deviations for each unique value of a covariate, in addition to topics."}, {"id": 45, "string": "4 Because of the Dirichlet-multinomial conjugacy in the original model, efficient inference algorithms exist for LDA."}, {"id": 46, "string": "Each variation of LDA, however, has required the derivation of a custom inference algorithm, which is a time-consuming and errorprone process."}, {"id": 47, "string": "In SLDA, for example, each type of distribution we might assume for p(y | \u03b8) would require a modification of the inference algorithm."}, {"id": 48, "string": "SAGE breaks conjugacy, and as such, the authors adopted L-BFGS for optimizing the variational bound."}, {"id": 49, "string": "Moreover, in order to maintain computational efficiency, it assumed that covariates were limited to a single categorical label."}, {"id": 50, "string": "More recently, the variational autoencoder (VAE) was introduced as a way to perform approximate posterior inference on models with otherwise intractable posteriors (Kingma and Welling, 2014; Rezende et al., 2014) ."}, {"id": 51, "string": "This approach has previously been applied to models of text by Miao et al."}, {"id": 52, "string": "(2016) and Srivastava and Sutton (2017) ."}, {"id": 53, "string": "We build on their work and show how this framework can be adapted to seamlessly incorporate the ideas of both SAGE and SLDA, while allowing for greater flexibility in the use of metadata."}, {"id": 54, "string": "Moreover, by exploiting automatic differentiation, we allow for modification of the model without requiring any change to the inference procedure."}, {"id": 55, "string": "The result is not only a highly adaptable family of models with scalable inference and efficient prediction; it also points the way to incorporation of many ideas found in the literature, such as a gradual evolution of topics , and hierarchical models (Blei et al., 2010; Nguyen et al., 2013 Nguyen et al., , 2015b )."}, {"id": 56, "string": "SCHOLAR: A Neural Topic Model with Covariates, Supervision, and Sparsity We begin by presenting the generative story for our model, and explain how it generalizes both SLDA and SAGE ( \u00a73.1)."}, {"id": 57, "string": "We then provide a general explanation of inference using VAEs and how it applies to our model ( \u00a73.2), as well as how to infer docu-4 A third way of incorporating metadata is the approach used by various \"upstream\" models, such as Dirichletmultinomial regression (Mimno and McCallum, 2008) , which uses observed metadata to inform the document prior."}, {"id": 58, "string": "We hypothesize that this approach could be productively combined with our framework, but we leave this as future work."}, {"id": 59, "string": "ment representations and predict labels at test time ( \u00a73.3)."}, {"id": 60, "string": "Finally, we discuss how we can incorporate additional prior knowledge ( \u00a73.4)."}, {"id": 61, "string": "Generative Story Consider a corpus of D documents, where document i is a list of N i words, w i , with V words in the vocabulary."}, {"id": 62, "string": "For each document, we may have observed covariates c i (e.g., year of publication), and/or one or more labels, y i (e.g., sentiment)."}, {"id": 63, "string": "Our model builds on the generative story of LDA, but optionally incorporates labels and covariates, and replaces the matrix product of \u0398 and B with a more flexible generative network, f g , followed by a softmax transform."}, {"id": 64, "string": "Instead of using a Dirichlet prior as in LDA, we employ a logistic normal prior on \u03b8 as in Srivastava and Sutton (2017) to facilitate inference ( \u00a73.2): we draw a latent variable, r, 5 from a multivariate normal, and transform it to lie on the simplex using a softmax transform."}, {"id": 65, "string": "6 The generative story is shown in Figure 1a and described in equations below: For each document i of length N i : # Draw a latent representation on the simplex from a logistic normal prior: r i \u223c N (r | \u00b5 0 (\u03b1), diag(\u03c3 2 0 (\u03b1))) \u03b8 i = softmax(r i ) # Generate words, incorporating covariates: \u03b7 i = f g (\u03b8 i , c i ) For each word j in document i: w ij \u223c p(w | softmax(\u03b7 i )) # Similarly generate labels: y i \u223c p(y | f y (\u03b8 i , c i )), where p(w | softmax(\u03b7 i )) is a multinomial distribution and p(y | f y (\u03b8 i , c i )) is a distribution appropriate to the data (e.g., multinomial for categorical labels)."}, {"id": 66, "string": "f g is a model-specific combination of latent variables and covariates, f y is a multi-layer neural network, and \u00b5 0 (\u03b1) and \u03c3 2 0 (\u03b1) are the mean and diagonal covariance terms of a multivariate normal prior."}, {"id": 67, "string": "To approximate a symmetric Dirichlet prior with hyperparameter \u03b1, these are given by the Laplace approximation (Hennig et al., 2012) to be \u00b5 0,k (\u03b1) = 0 and \u03c3 2 0,k = (K \u2212 1)/(\u03b1K)."}, {"id": 68, "string": "If we were to ignore covariates, place a Dirichlet prior on B, and let \u03b7 = \u03b8 i B, this model is equivalent to SLDA with a logistic normal prior."}, {"id": 69, "string": "Similarly, we can recover a model that is like SAGE, but lacks sparsity, if we ignore labels, and let (1) where d is the V -dimensional background term (representing the log of the overall word frequency), \u03b8 i \u2297 c i is a vector of interactions between topics and covariates, and B cov and B int are additional weight (deviation) matrices."}, {"id": 70, "string": "The background is included to account for common words with approximately the same frequency across documents, meaning that the B * weights now represent both positive and negative deviations from this background."}, {"id": 71, "string": "This is the form of f g which we will use in our experiments."}, {"id": 72, "string": "\u03b7 i = d + \u03b8 i B + c i B cov + (\u03b8 i \u2297 c i ) B int , To recover the full SAGE model, we can place a sparsity-inducing prior on each B * ."}, {"id": 73, "string": "As in Eisenstein et al."}, {"id": 74, "string": "(2011) , we make use of the compound normal-exponential prior for each element of the weight matrices, B * m,n , with hyperparameter \u03b3, 7 \u03c4 m,n \u223c Exponential(\u03b3), (2) B * m,n \u223c N (0, \u03c4 m,n )."}, {"id": 75, "string": "(3) We can choose to ignore various parts of this model, if, for example, we don't have any labels or observed covariates, or we don't wish to use interactions or sparsity."}, {"id": 76, "string": "8 Other generator networks could also be considered, with additional layers to represent more complex interactions, although this might involve some loss of interpretability."}, {"id": 77, "string": "In the absence of metadata, and without sparsity, our model is equivalent to the ProdLDA model of Srivastava and Sutton (2017) with an explicit background term, and ProdLDA is, in turn, a 7 To avoid having to tune \u03b3, we employ an improper Jeffery's prior, p(\u03c4m,n) \u221d 1/\u03c4m,n, as in SAGE."}, {"id": 78, "string": "Although this causes difficulties in posterior inference for the variance terms, \u03c4 , in practice, we resort to a variational EM approach, with MAP-estimation for the weights, B, and thus alternate between computing expectations of the \u03c4 parameters, and updating all other parameters using some variant of stochastic gradient descent."}, {"id": 79, "string": "For this, we only require the expectation of each \u03c4mn for each E-step, which is given by 1/B 2 m,n ."}, {"id": 80, "string": "We refer the reader to Eisenstein et al."}, {"id": 81, "string": "(2011) for additional details."}, {"id": 82, "string": "8 We could also ignore latent topics, in which case we would get a na\u00efve Bayes-like model of text with deviations for each covariate p(wij | ci) \u221d exp(d + c i B cov )."}, {"id": 83, "string": "Figure 1a presents the generative story of our model."}, {"id": 84, "string": "Figure 1b illustrates the inference network using the reparametrization trick to perform variational inference on our model."}, {"id": 85, "string": "Shaded nodes are observed; double circles indicate deterministic transformations of parent nodes."}, {"id": 86, "string": "special case of SAGE, without background logfrequencies, sparsity, covariates, or labels."}, {"id": 87, "string": "In the next section we generalize the inference method used for ProdLDA; in our experiments we validate its performance and explore the effects of regularization and word-vector initialization ( \u00a73.4)."}, {"id": 88, "string": "The NVDM (Miao et al., 2016) uses the same approach to inference, but does not not restrict document representations to the simplex."}, {"id": 89, "string": "Learning and Inference As in past work, each document i is assumed to have a latent representation r i , which can be interpreted as its relative membership in each topic (after exponentiating and normalizing)."}, {"id": 90, "string": "In order to infer an approximate posterior distribution over r i , we adopt the sampling-based VAE framework developed in previous work (Kingma and Welling, 2014; Rezende et al., 2014) ."}, {"id": 91, "string": "As in conventional variational inference, we assume a variational approximation to the posterior, q \u03a6 (r i | w i , c i , y i ), and seek to minimize the KL divergence between it and the true posterior, p(r i | w i , c i , y i ), where \u03a6 is the set of variational parameters to be defined below."}, {"id": 92, "string": "After some manipulations (given in supplementary materials), we obtain the evidence lower bound (ELBO) for a sin-gle document, L(w i ) = E q \u03a6 (r i |w i ,c i ,y i ) \uf8ee \uf8f0 N i j=1 log p(w ij | r i , c i ) \uf8f9 \uf8fb + E q \u03a6 (r i |w i ,c i ,y i ) [log p(y i | r i , c i )] \u2212 D KL [q \u03a6 (r i | w i , c i , y i ) || p(r i | \u03b1)] ."}, {"id": 93, "string": "(4) As in the original VAE, we will encode the parameters of our variational distributions using a shared multi-layer neural network."}, {"id": 94, "string": "Because we have assumed a diagonal normal prior on r, this will take the form of a network which outputs a mean vector, \u00b5 i = f \u00b5 (w i , c i , y i ) and diagonal of a covariance matrix, \u03c3 2 i = f \u03c3 (w i , c i , y i ), such that q \u03a6 (r i | w i , c i , y i ) = N (\u00b5 i , \u03c3 2 i ) ."}, {"id": 95, "string": "Incorporating labels and covariates to the inference network used by Miao et al."}, {"id": 96, "string": "(2016) and Srivastava and Sutton (2017) , we use: \u03c0 i = f e ([W x x i ; W c c i ; W y y i ]), (5) \u00b5 i = W \u00b5 \u03c0 i + b \u00b5 , (6) log \u03c3 2 i = W \u03c3 \u03c0 i + b \u03c3 , (7) where x i is a V -dimensional vector representing the counts of words in w i , and f e is a multilayer perceptron."}, {"id": 97, "string": "The full set of encoder parameters, \u03a6, thus includes the parameters of f e and all weight matrices and bias vectors in Equations 5-7 (see Figure 1b )."}, {"id": 98, "string": "This approach means that the expectations in Equation 4 are intractable, but we can approximate them using sampling."}, {"id": 99, "string": "In order to maintain differentiability with respect to \u03a6, even after sampling, we make use of the reparameterization trick (Kingma and Welling, 2014), 9 which allows us to reparameterize samples from q \u03a6 (r | w i , c i , y i ) in terms of samples from an independent source of noise, i.e., (s) \u223c N (0, I), r (s) i = g \u03a6 (w i , c i , y i , (s) ) = \u00b5 i + \u03c3 i \u00b7 (s) ."}, {"id": 100, "string": "We thus replace the bound in Equation 4 with a Monte Carlo approximation using a single sam- 9 The Dirichlet distribution cannot be directly reparameterized in this way, which is why we use the logistic normal prior on \u03b8 to approximate the Dirichlet prior used in LDA."}, {"id": 101, "string": "ple 10 of (and thereby of r): L(w i ) \u2248 N i j=1 log p(w ij | r (s) i , c i ) + log p(y i | r (s) i , c i ) \u2212 D KL [q \u03a6 (r i | w i , c i , y i ) || p(r i | \u03b1)] ."}, {"id": 102, "string": "(8) We can now optimize this sampling-based approximation of the variational bound with respect to \u03a6, B * , and all parameters of f g and f y using stochastic gradient descent."}, {"id": 103, "string": "Moreover, because of this stochastic approach to inference, we are not restricted to covariates with a small number of unique values, which was a limitation of SAGE."}, {"id": 104, "string": "Finally, the KL divergence term in Equation 8 can be computed in closed form (see supplementary materials)."}, {"id": 105, "string": "Prediction on Held-out Data In addition to inferring latent topics, our model can both infer latent representations for new documents and predict their labels, the latter of which was the motivation for SLDA."}, {"id": 106, "string": "In traditional variational inference, inference at test time requires fixing global parameters (topics), and optimizing the per-document variational parameters for the test set."}, {"id": 107, "string": "With the VAE framework, by contrast, the encoder network (Equations 5-7) can be used to directly estimate the posterior distribution for each test document, using only a forward pass (no iterative optimization or sampling)."}, {"id": 108, "string": "If not using labels, we can use this approach directly, passing the word counts of new documents through the encoder to get a posterior q \u03a6 (r i | w i , c i )."}, {"id": 109, "string": "When we also include labels to be predicted, we can first train a fully-observed model, as above, then fix the decoder, and retrain the encoder without labels."}, {"id": 110, "string": "In practice, however, if we train the encoder network using one-hot encodings of document labels, it is sufficient to provide a vector of all zeros for the labels of test documents; this is what we adopt for our experiments ( \u00a74.2), and we still obtain good predictive performance."}, {"id": 111, "string": "The label network, f y , is a flexible component which can be used to predict a wide range of outcomes, from categorical labels (such as star ratings; McAuliffe and Blei, 2008) to real-valued outputs (such as number of citations or box-office returns; Yogatama et al., 2011) ."}, {"id": 112, "string": "For categorical labels, predictions are given b\u0177 y i = argmax y \u2208 Y p(y | r i , c i )."}, {"id": 113, "string": "(9) Alternatively, when dealing with a small set of categorical labels, it is also possible to treat them as observed categorical covariates during training."}, {"id": 114, "string": "At test time, we can then consider all possible one-hot vectors, e, in place of c i , and predict the label that maximizes the probability of the words, i.e., y i = argmax y \u2208 Y N i j=1 log p(w ij | r i , e y )."}, {"id": 115, "string": "(10) This approach works well in practice (as we show in \u00a74.2), but does not scale to large numbers of labels, or other types of prediction problems, such as multi-class classification or regression."}, {"id": 116, "string": "The choice to include metadata as covariates, labels, or both, depends on the data."}, {"id": 117, "string": "The key point is that we can incorporate metadata in two very different ways, depending on what we want from the model."}, {"id": 118, "string": "Labels guide the model to infer topics that are relevant to those labels, whereas covariates induce explicit deviations, leaving the latent variables to account for the rest of the content."}, {"id": 119, "string": "Additional Prior Information A final advantage of the VAE framework is that the encoder network provides a way to incorporate additional prior information in the form of word vectors."}, {"id": 120, "string": "Although we can learn all parameters starting from a random initialization, it is also possible to initialize and fix the initial embeddings of words in the model, W x , in Equation 5."}, {"id": 121, "string": "This leverages word similarities derived from large amounts of unlabeled data, and may promote greater coherence in inferred topics."}, {"id": 122, "string": "The same could also be done for some covariates; for example, we could embed the source of a news article based on its place on the ideological spectrum."}, {"id": 123, "string": "Conversely, if we choose to learn these parameters, the learned values (W y and W c ) may provide meaningful embeddings of these metadata (see section \u00a74.3)."}, {"id": 124, "string": "Other variants on topic models have also proposed incorporating word vectors, both as a parallel part of the generative process (Nguyen et al., 2015a) , and as an alternative parameterization of topic distributions (Das et al., 2015) , but inference is not scalable in either of these models."}, {"id": 125, "string": "Because of the generality of the VAE framework, we could also modify the generative story so that word embeddings are emitted (rather than tokens); we leave this for future work."}, {"id": 126, "string": "Experiments and Results To evaluate and demonstrate the potential of this model, we present a series of experiments below."}, {"id": 127, "string": "We first test SCHOLAR without observed metadata, and explore the effects of using regularization and/or word vector initialization, compared to LDA, SAGE, and NVDM ( \u00a74.1)."}, {"id": 128, "string": "We then evaluate our model in terms of predictive performance, in comparison to SLDA and an l 2 -regularized logistic regression baseline ( \u00a74.2)."}, {"id": 129, "string": "Finally, we demonstrate the ability to incorporate covariates and/or labels in an exploratory data analysis ( \u00a74.3)."}, {"id": 130, "string": "The scores we report are generalization to heldout data, measured in terms of perplexity; coherence, measured in terms of non-negative point-wise mutual information (NPMI; Chang et al., 2009; Newman et al., 2010) , and classification accuracy on test data."}, {"id": 131, "string": "For coherence we evaluate NPMI using the top 10 words of each topic, both internally (using test data), and externally, using a decade of articles from the English Gigaword dataset (Graff and Cieri, 2003) ."}, {"id": 132, "string": "Since our model employs variational methods, the reported perplexity is an upper bound based on the ELBO."}, {"id": 133, "string": "As datasets we use the familiar 20 newsgroups, the IMDB corpus of 50,000 movie reviews (Maas et al., 2011) , and the UIUC Yahoo answers dataset with 150,000 documents in 15 categories (Chang et al., 2008) ."}, {"id": 134, "string": "For further exploration, we also make use of a corpus of approximately 4,000 timestamped news articles about US immigration, each annotated with pro-or anti-immigration tone (Card et al., 2015) ."}, {"id": 135, "string": "We use the original author-provided implementations of SAGE 11 and SLDA, 12 while for LDA we use Mallet."}, {"id": 136, "string": "13 ."}, {"id": 137, "string": "Our implementation of SCHOLAR is in TensorFlow, but we have also provided a preliminary PyTorch implementation of the core of our model."}, {"id": 138, "string": "14 For additional details about datasets and implementation, please refer to the supplementary material."}, {"id": 139, "string": "It is challenging to fairly evaluate the relative computational efficiency of our approach compared to past work (due to the stochastic nature of our ap-11 github.com/jacobeisenstein/SAGE 12 github.com/blei-lab/class-slda 13 mallet.cs.umass.edu 14 github.com/dallascard/scholar proach to inference, choices about hyperparameters such as tolerance, and because of differences in implementation)."}, {"id": 140, "string": "Nevertheless, in practice, the performance of our approach is highly appealing."}, {"id": 141, "string": "For all experiments in this paper, our implementation was much faster than SLDA or SAGE (implemented in C and Matlab, respectively), and competitive with Mallet."}, {"id": 142, "string": "Unsupervised Evaluation Although the emphasis of this work is on incorporating observed labels and/or covariates, we briefly report on experiments in the unsupervised setting."}, {"id": 143, "string": "Recall that, without metadata, SCHOLAR equates to ProdLDA, but with an explicit background term."}, {"id": 144, "string": "15 We therefore use the same experimental setup as Srivastava and Sutton (2017) (learning rate, momentum, batch size, and number of epochs) and find the same general patterns as they reported (see Table 1 and supplementary material): our model returns more coherent topics than LDA, but at the cost of worse perplexity."}, {"id": 145, "string": "SAGE, by contrast, attains very high levels of sparsity, but at the cost of worse perplexity and coherence than LDA."}, {"id": 146, "string": "As expected, the NVDM produces relatively low perplexity, but very poor coherence, due to its lack of constraints on \u03b8."}, {"id": 147, "string": "Further experimentation revealed that the VAE framework involves a tradeoff among the scores; running for more epochs tends to result in better perplexity on held-out data, but at the cost of worse coherence."}, {"id": 148, "string": "Adding regularization to encourage sparse topics has a similar effect as in SAGE, leading to worse perplexity and coherence, but it does create sparse topics."}, {"id": 149, "string": "Interestingly, initializing the encoder with pretrained word2vec embeddings, and not updating them returned a model with the best internal coherence of any model we considered for IMDB and Yahoo answers, and the second-best for 20 newsgroups."}, {"id": 150, "string": "The background term in our model does not have much effect on perplexity, but plays an important role in producing coherent topics; as in SAGE, the background can account for common words, so they are mostly absent among the most heavily weighted words in the topics."}, {"id": 151, "string": "For instance, words like film and movie in the IMDB corpus are relatively unimportant in the topics learned by our Table 1 : Performance of our various models in an unsupervised setting (i.e., without labels or covariates) on the IMDB dataset using a 5,000-word vocabulary and 50 topics."}, {"id": 152, "string": "The supplementary materials contain additional results for 20 newsgroups and Yahoo answers."}, {"id": 153, "string": "model, but would be much more heavily weighted without the background term, as they are in topics learned by LDA."}, {"id": 154, "string": "Text Classification We next consider the utility of our model in the context of categorical labels, and consider them alternately as observed covariates and as labels generated conditional on the latent representation."}, {"id": 155, "string": "We use the same setup as above, but tune number of training epochs for our model using a random 20% of training data as a development set, and similarly tune regularization for logistic regression."}, {"id": 156, "string": "Table 2 summarizes the accuracy of various models on three datasets, revealing that our model offers competitive performance, both as a joint model of words and labels (Eq."}, {"id": 157, "string": "9), and a model which conditions on covariates (Eq."}, {"id": 158, "string": "10)."}, {"id": 159, "string": "Although SCHOLAR is comparable to the logistic regression baseline, our purpose here is not to attain state-of-the-art performance on text classification."}, {"id": 160, "string": "Rather, the high accuracies we obtain demonstrate that we are learning low-dimensional representations of documents that are relevant to the label of interest, outperforming SLDA, and have the same attractive properties as topic models."}, {"id": 161, "string": "Further, any neural network that is successful for text classification could be incorporated into f y and trained end-to-end along with topic discovery."}, {"id": 162, "string": "Exploratory Study We demonstrate how our model might be used to explore an annotated corpus of articles about immigration, and adapt to different assumptions about the data."}, {"id": 163, "string": "We only use a small number of topics in this part (K = 8) for compact presentation."}, {"id": 164, "string": "Tone as a label."}, {"id": 165, "string": "We first consider using the annotations as a label, and train a joint model to infer topics relevant to the tone of the article (pro-or anti-immigration)."}, {"id": 166, "string": "Figure 2 shows a set of topics learned in this way, along with the predicted probability of an article being pro-immigration conditioned on the given topic."}, {"id": 167, "string": "All topics are coherent, and the predicted probabilities have strong face validity, e.g., \"arrested charged charges agents operation\" is least associated with pro-immigration."}, {"id": 168, "string": "Tone as a covariate."}, {"id": 169, "string": "Next we consider using tone as a covariate, and build a model using both tone and tone-topic interactions."}, {"id": 170, "string": "Table 3 shows a set of topics learned from the immigration data, along with the most highly-weighted words in the corresponding tone-topic interaction terms."}, {"id": 171, "string": "As can be seen, these interaction terms tend to capture different frames (e.g., \"criminal\" vs. \"detainees\", and \"illegals\" vs. \"newcomers\", etc)."}, {"id": 172, "string": "Combined model with temporal metadata."}, {"id": 173, "string": "Finally, we incorporate both the tone annotations and the year of publication of each article, treating the former as a label and the latter as a covariate."}, {"id": 174, "string": "In this model, we also include an embedding matrix, W c , to project the one-hot year vectors down to a two-dimensional continuous space, with a learned deviation for each dimension."}, {"id": 175, "string": "We omit the topics in the interest of space, but Figure 3 shows the learned embedding for each year, along with the top terms of the corresponding deviations."}, {"id": 176, "string": "As can be seen, the model learns that adjacent years tend to produce similar deviations, even though we have not explicitly encoded this information."}, {"id": 177, "string": "The leftright dimension roughly tracks a temporal trend with positive deviations shifting from the years of Clinton and INS on the left, to Obama and ICE on the right."}, {"id": 178, "string": "16 Meanwhile, the events of 9/11 dominate the vertical direction, with the words sept, hijackers, and attacks increasing in probability as we move up in the space."}, {"id": 179, "string": "If we wanted to look at each year individually, we could drop the embedding of years, and learn a sparse set of topic-year interactions, similar to tone in Table 3 ."}, {"id": 180, "string": "Additional Related Work The literature on topic models is vast; in addition to papers cited throughout, other efforts to incorporate metadata into topic models include Dirichletmultinomial regression (DMR; Mimno and McCallum, 2008) , Labeled LDA (Ramage et al., 2009) , and MedLDA (Zhu et al., 2009) ."}, {"id": 181, "string": "A recent paper also extended DMR by using deep neural networks to embed metadata into a richer document prior (Benton and Dredze, 2018) ."}, {"id": 182, "string": "A separate line of work has pursued parameterizing unsupervised models of documents using neural networks (Hinton and Salakhutdinov, Base topics (each row is a topic) Anti-immigration interactions Pro-immigration interactions ice customs agency enforcement homeland criminal customs arrested detainees detention center agency population born percent americans english jobs million illegals taxpayers english newcomers hispanic city judge case court guilty appeals attorney guilty charges man charged asylum court judge case appeals patrol border miles coast desert boat guard patrol border agents boat died authorities desert border bodies licenses drivers card visa cards applicants foreign sept visas system green citizenship card citizen apply island story chinese ellis international smuggling federal charges island school ellis english story guest worker workers bush labor bill bill border house senate workers tech skilled farm labor benefits bill welfare republican state senate republican california gov state law welfare students tuition Table 3 : Top words for topics (left) and the corresponding anti-immigration (middle) and pro-immigration (right) variations when treating tone as a covariate, with interactions."}, {"id": 183, "string": "2009; Larochelle and Lauly, 2012) , including non-Bayesian approaches (Cao et al., 2015) ."}, {"id": 184, "string": "More recently, Lau et al."}, {"id": 185, "string": "(2017) proposed a neural language model that incorporated topics, and He et al."}, {"id": 186, "string": "(2017) developed a scalable alternative to the correlated topic model by simultaneously learning topic embeddings."}, {"id": 187, "string": "Others have attempted to extend the reparameterization trick to the Dirichlet and Gamma distributions, either through transformations  or a generalization of reparameterization (Ruiz et al., 2016) ."}, {"id": 188, "string": "Black-box and VAE-style inference have been implemented in at least two general purpose tools designed to allow rapid exploration and evaluation of models (Kucukelbir et al., 2015; ."}, {"id": 189, "string": "Conclusion We have presented a neural framework for generalized topic models to enable flexible incorporation of metadata with a variety of options."}, {"id": 190, "string": "We take advantage of stochastic variational inference to develop a general algorithm for our framework such that variations do not require any model-specific algorithm derivations."}, {"id": 191, "string": "Our model demonstrates the tradeoff between perplexity, coherence, and sparsity, and outperforms SLDA in predicting document labels."}, {"id": 192, "string": "Furthermore, the flexibility of our model enables intriguing exploration of a text corpus on US immigration."}, {"id": 193, "string": "We believe that our model and code will facilitate rapid exploration of document collections with metadata."}], "headers": [{"section": "Introduction", "n": "1", "start": 0, "end": 24}, {"section": "Background and Motivation", "n": "2", "start": 25, "end": 55}, {"section": "SCHOLAR: A Neural Topic Model with Covariates, Supervision, and Sparsity", "n": "3", "start": 56, "end": 60}, {"section": "Generative Story", "n": "3.1", "start": 61, "end": 88}, {"section": "Learning and Inference", "n": "3.2", "start": 89, "end": 104}, {"section": "Prediction on Held-out Data", "n": "3.3", "start": 105, "end": 118}, {"section": "Additional Prior Information", "n": "3.4", "start": 119, "end": 125}, {"section": "Experiments and Results", "n": "4", "start": 126, "end": 141}, {"section": "Unsupervised Evaluation", "n": "4.1", "start": 142, "end": 153}, {"section": "Text Classification", "n": "4.2", "start": 154, "end": 161}, {"section": "Exploratory Study", "n": "4.3", "start": 162, "end": 179}, {"section": "Additional Related Work", "n": "5", "start": 180, "end": 188}, {"section": "Conclusion", "n": "6", "start": 189, "end": 193}], "figures": [{"filename": "../figure/image/975-Table3-1.png", "caption": "Table 3: Top words for topics (left) and the corresponding anti-immigration (middle) and pro-immigration (right) variations when treating tone as a covariate, with interactions.", "page": 8, "bbox": {"x1": 81.6, "x2": 513.12, "y1": 63.36, "y2": 151.68}}, {"filename": "../figure/image/975-Table2-1.png", "caption": "Table 2: Accuracy of various models on three datasets with categorical labels.", "page": 7, "bbox": {"x1": 79.67999999999999, "x2": 283.2, "y1": 63.36, "y2": 136.79999999999998}}, {"filename": "../figure/image/975-Figure3-1.png", "caption": "Figure 3: Learned embeddings of year-ofpublication (treated as a covariate) from combined model of news articles about immigration.", "page": 7, "bbox": {"x1": 311.52, "x2": 527.52, "y1": 275.52, "y2": 420.47999999999996}}, {"filename": "../figure/image/975-Figure2-1.png", "caption": "Figure 2: Topics inferred by a joint model of words and tone, and the corresponding probability of proimmigration tone for each topic. A topic is represented by the top words sorted by word probability throughout the paper.", "page": 7, "bbox": {"x1": 312.96, "x2": 527.52, "y1": 67.67999999999999, "y2": 175.68}}, {"filename": "../figure/image/975-Figure1-1.png", "caption": "Figure 1: Figure 1a presents the generative story of our model. Figure 1b illustrates the inference network using the reparametrization trick to perform variational inference on our model. Shaded nodes are observed; double circles indicate deterministic transformations of parent nodes.", "page": 3, "bbox": {"x1": 306.71999999999997, "x2": 522.24, "y1": 62.879999999999995, "y2": 287.52}}, {"filename": "../figure/image/975-Table1-1.png", "caption": "Table 1: Performance of our various models in an unsupervised setting (i.e., without labels or covariates) on the IMDB dataset using a 5,000-word vocabulary and 50 topics. The supplementary materials contain additional results for 20 newsgroups and Yahoo answers.", "page": 6, "bbox": {"x1": 306.71999999999997, "x2": 531.36, "y1": 63.36, "y2": 155.04}}]}