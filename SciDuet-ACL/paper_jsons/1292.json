{"title": "Are BLEU and Meaning Representation in Opposition?", "abstract": "One of possible ways of obtaining continuous-space sentence representations is by training neural machine translation (NMT) systems. The recent attention mechanism however removes the single point in the neural network from which the source sentence representation can be extracted. We propose several variations of the attentive NMT architecture bringing this meeting point back. Empirical evaluation suggests that the better the translation quality, the worse the learned sentence representations serve in a wide range of classification and similarity tasks.", "text": [{"id": 0, "string": "Introduction Deep learning has brought the possibility of automatically learning continuous representations of sentences."}, {"id": 1, "string": "On the one hand, such representations can be geared towards particular tasks such as classifying the sentence in various aspects (e.g."}, {"id": 2, "string": "sentiment, register, question type) or relating the sentence to other sentences (e.g."}, {"id": 3, "string": "semantic similarity, paraphrasing, entailment)."}, {"id": 4, "string": "On the other hand, we can aim at \"universal\" sentence representations, that is representations performing reasonably well in a range of such tasks."}, {"id": 5, "string": "Regardless the evaluation criterion, the representations can be learned either in an unsupervised way (from simple, unannotated texts) or supervised, relying on manually constructed training sets of sentences equipped with annotations of the appropriate type."}, {"id": 6, "string": "A different approach is to obtain sentence representations from training neural machine translation models (Hill et al., 2016) ."}, {"id": 7, "string": "Since Hill et al."}, {"id": 8, "string": "(2016) , NMT has seen substantial advances in translation quality and it is thus natural to ask how these improvements affect the learned representations."}, {"id": 9, "string": "One of the key technological changes was the introduction of \"attention\" , making it even the very central component in the network (Vaswani et al., 2017) ."}, {"id": 10, "string": "Attention allows the NMT system to dynamically choose which parts of the source are most important when deciding on the current output token."}, {"id": 11, "string": "As a consequence, there is no longer a static vector representation of the sentence available in the system."}, {"id": 12, "string": "In this paper, we remove this limitation by proposing a novel encoder-decoder architecture with a structured fixed-size representation of the input that still allows the decoder to explicitly focus on different parts of the input."}, {"id": 13, "string": "In other words, our NMT system has both the capacity to attend to various parts of the input and to produce static representations of input sentences."}, {"id": 14, "string": "We train this architecture on English-to-German and English-to-Czech translation and evaluate the learned representations of English on a wide range of tasks in order to assess its performance in learning \"universal\" meaning representations."}, {"id": 15, "string": "In Section 2, we briefly review recent efforts in obtaining sentence representations."}, {"id": 16, "string": "In Section 3, we introduce a number of variants of our novel architecture."}, {"id": 17, "string": "Section 4 describes some standard and our own methods for evaluating sentence representations."}, {"id": 18, "string": "Section 5 then provides experimental results: translation and representation quality."}, {"id": 19, "string": "The relation between the two is discussed in Section 6."}, {"id": 20, "string": "Related Work The properties of continuous sentence representations have always been of interest to researchers working on neural machine translation."}, {"id": 21, "string": "In the first works on RNN sequence-to-sequence models,  and Sutskever et al."}, {"id": 22, "string": "(2014) Table 1 : Different RNN-based architectures and their properties."}, {"id": 23, "string": "Legend: \"pooling\" -vectors combined by mean or max (AVGPOOL, MAXPOOL); \"sent."}, {"id": 24, "string": "emb.\""}, {"id": 25, "string": "-sentence embedding, i.e."}, {"id": 26, "string": "the fixed-size sentence representation computed by the encoder."}, {"id": 27, "string": "\"init\" -initial decoder state."}, {"id": 28, "string": "\"ctx\" -context vector, i.e."}, {"id": 29, "string": "input for the decoder cell."}, {"id": 30, "string": "\"input for att.\""}, {"id": 31, "string": "-input for the decoder attention."}, {"id": 32, "string": "provided visualizations of the phrase and sentence embedding spaces and observed that they reflect semantic and syntactic structure to some extent."}, {"id": 33, "string": "Hill et al."}, {"id": 34, "string": "(2016) perform a systematic evaluation of sentence representation in different models, including NMT, by applying them to various sentence classification tasks and by relating semantic similarity to closeness in the representation space."}, {"id": 35, "string": "Shi et al."}, {"id": 36, "string": "(2016) investigate the syntactic properties of representations learned by NMT systems by predicting sentence-and word-level syntactic labels (e.g."}, {"id": 37, "string": "tense, part of speech) and by generating syntax trees from these representations."}, {"id": 38, "string": "Schwenk and Douze (2017) aim to learn language-independent sentence representations using NMT systems with multiple source and target languages."}, {"id": 39, "string": "They do not consider the attention mechanism and evaluate primarily by similarity scores of the learned representations for similar sentences (within or across languages)."}, {"id": 40, "string": "Model Architectures Our proposed model architectures differ in (a) which encoder states are considered in subsequent processing, (b) how they are combined, and (c) how they are used in the decoder."}, {"id": 41, "string": "Table 1 summarizes all the examined configurations of RNN-based models."}, {"id": 42, "string": "The first three (ATTN, FINAL, FINAL-CTX) correspond roughly to the standard sequence-to-sequence models, , Sutskever et al."}, {"id": 43, "string": "(2014) and , resp."}, {"id": 44, "string": "The last column (ATTN-ATTN) is our main proposed architecture: compound attention, described here in Section 3.1."}, {"id": 45, "string": "In addition to RNN-based models, we experiment with the Transformer model, see Section 3.3. s 1 s 2 s 3 s T \ufffd + c 3 \u2212 \u2192 h 1 \u2190 \u2212 h 1 \u2212 \u2192 h 2 \u2190 \u2212 h 2 \u2212 \u2192 h 3 \u2190 \u2212 h 3 \u2212 \u2192 h T \u2190 \u2212 h T + \u03b1 21 \u03b1 22 \u03b1 23 \u03b1 2T ."}, {"id": 46, "string": "."}, {"id": 47, "string": "."}, {"id": 48, "string": "M 2 M 1 M 3 M 4 \u03b2 31 \u03b2 32 \u03b2 33 \u03b2 34 = M \ufffd = H decoder encoder x 1 x 2 x 3 x T ."}, {"id": 49, "string": "."}, {"id": 50, "string": "."}, {"id": 51, "string": "Figure 1 : An illustration of compound attention with 4 attention heads."}, {"id": 52, "string": "The figure shows the computations that result in the decoder state s 3 (in addition, each state s i depends on the previous target token y i\u22121 )."}, {"id": 53, "string": "Note that the matrix M is the same for all positions in the output sentence and it can thus serve as the source sentence representation."}, {"id": 54, "string": "Compound Attention Our compound attention model incorporates attention in both the encoder and the decoder, Fig."}, {"id": 55, "string": "1 ."}, {"id": 56, "string": "Encoder with inner attention."}, {"id": 57, "string": "First, we process the input sequence x 1 , x 2 , ."}, {"id": 58, "string": "."}, {"id": 59, "string": "."}, {"id": 60, "string": ", x T using a bidirectional recurrent network with gated recurrent units (GRU, Cho et al., 2014) : \u2212 \u2192 h t = \u2212\u2212\u2192 GRU(x t , \u2212 \u2212 \u2192 h t\u22121 ), \u2190 \u2212 h t = \u2190\u2212\u2212 GRU(x t , \u2190 \u2212 \u2212 h t+1 ), h t = [ \u2212 \u2192 h t , \u2190 \u2212 h t ]."}, {"id": 61, "string": "We denote by u the combined number of units in the two RNNs, i.e."}, {"id": 62, "string": "the dimensionality of h t ."}, {"id": 63, "string": "Next, our goal is to combine the states (h 1 , h 2 , ."}, {"id": 64, "string": "."}, {"id": 65, "string": "."}, {"id": 66, "string": ", h T ) = H of the encoder into a vector of fixed dimensionality that represents the entire sentence."}, {"id": 67, "string": "Traditional seq2seq models concatenate the final states of both encoder RNNs ( \u2212 \u2192 h T and \u2190 \u2212 h 1 ) to obtain the sentence representation (denoted as FINAL in Table 1 )."}, {"id": 68, "string": "Another option is to combine all encoder states using the average or maximum over time (Collobert and Weston, 2008; Schwenk and Douze, 2017 ) (AVGPOOL and MAXPOOL in Table 1 and following)."}, {"id": 69, "string": "We adopt an alternative approach, which is to use inner attention 1 (Liu et al., 2016; Li et al., 2016) to compute several weighted averages of the encoder states (Lin et al., 2017) ."}, {"id": 70, "string": "The main motivation for incorporating these multiple \"views\" of the state sequence is that it removes the need for the RNN cell to accumulate the representation of the whole sentence as it processes the input, and therefore it should have more capacity for modeling local dependencies."}, {"id": 71, "string": "Specifically, we fix a number r, the number of attention heads, and compute an r \u00d7T matrix A of attention weights \u03b1 jt , representing the importance of position t in the input for the j th attention head."}, {"id": 72, "string": "We then use this matrix to compute r weighted sums of the encoder states, which become the rows of a new matrix M : M = AH."}, {"id": 73, "string": "(1) A vector representation of the source sentence (the \"sentence embedding\") can be obtained by flattening the matrix M ."}, {"id": 74, "string": "In our experiments, we project the encoder states h 1 , h 2 , ."}, {"id": 75, "string": "."}, {"id": 76, "string": "."}, {"id": 77, "string": ", h T down to a given dimensionality before applying Eq."}, {"id": 78, "string": "(1), so that we can control the size of the representation."}, {"id": 79, "string": "Following Lin et al."}, {"id": 80, "string": "(2017) , we compute the attention matrix by feeding the encoder states to a two-layer feed-forward network: A = softmax(U tanh(W H \ufffd )), (2) where W and U are weight matrices of dimensions d \u00d7 u and r \u00d7 d, respectively (d is the number of hidden units); the softmax function is applied along the second dimension, i.e."}, {"id": 81, "string": "across the encoder states."}, {"id": 82, "string": "Attentive decoder."}, {"id": 83, "string": "In vanilla seq2seq models with a fixed-size sentence representation, the decoder is usually conditioned on this representation via the initial RNN state."}, {"id": 84, "string": "We propose to instead leverage the structured sentence embedding by applying attention to its components."}, {"id": 85, "string": "This is no different from the classical attention mechanism used in NMT , except that it acts on this fixed-size representation instead of the sequence of encoder states."}, {"id": 86, "string": "In the i th decoding step, the attention mechanism computes a distribution {\u03b2 ij } r j=1 over the r components of the structured representation."}, {"id": 87, "string": "This is then used to weight these components to obtain the context vector c i , which in turn is used to update the decoder state."}, {"id": 88, "string": "Again, we can write this in matrix form as C = BM, (3) where B = (\u03b2 ij ) T \ufffd ,r i=1,j=1 is the attention matrix and C = (c i , c 2 , ."}, {"id": 89, "string": "."}, {"id": 90, "string": "."}, {"id": 91, "string": ", c T \ufffd ) are the context vectors."}, {"id": 92, "string": "Note that by combining Eqs."}, {"id": 93, "string": "(1) and (3) , we get C = (BA)H. (4) Hence, the composition of the encoder and decoder attentions (the \"compound attention\") defines an implicit alignment between the source and the target sequence."}, {"id": 94, "string": "From this viewpoint, our model can be regarded as a restriction of the conventional attention model."}, {"id": 95, "string": "The decoder uses a conditional GRU cell (cGRU att ; Sennrich et al., 2017) , which consists of two consecutively applied GRU blocks."}, {"id": 96, "string": "The first block processes the previous target token y i\u22121 , while the second block receives the context vector c i and predicts the next target token y i ."}, {"id": 97, "string": "Constant Context Compared to the FINAL model, the compound attention architecture described in the previous section undoubtedly benefits from the fact that the decoder is presented with information from the encoder (i.e."}, {"id": 98, "string": "the context vectors c i ) in every decoding step."}, {"id": 99, "string": "To investigate this effect, we include baseline models where we replace all context vectors c i with the entire sentence embedding (indicated by the suffix \"-CTX\" in Table 1 )."}, {"id": 100, "string": "Specifically, we provide either the flattened matrix M (for models with inner attention; ATTN or ATTN-CTX), the final state of the encoder (FINAL-CTX), or the result of mean-or max-pooling (*POOL-CTX) as a constant input to the decoder cell."}, {"id": 101, "string": "Transformer with Inner Attention The Transformer (Vaswani et al., 2017) is a recently proposed model based entirely on feedforward layers and attention."}, {"id": 102, "string": "It consists of an encoder and a decoder, each with 6 layers, consisting of multi-head attention on the previous layer and a position-wise feed-forward network."}, {"id": 103, "string": "In order to introduce a fixed-size sentence representation into the model, we modify it by adding inner attention after the last encoder layer."}, {"id": 104, "string": "The attention in the decoder then operates on the components of this representation (i.e."}, {"id": 105, "string": "the rows of the matrix M )."}, {"id": 106, "string": "This variation on the Transformer model corresponds to the ATTN-ATTN column in Table 1 and is therefore denoted TRF-ATTN-ATTN."}, {"id": 107, "string": "Representation Evaluation Continuous sentence representations can be evaluated in many ways, see e.g."}, {"id": 108, "string": "Kiros et al."}, {"id": 109, "string": "(2015) , Conneau et al."}, {"id": 110, "string": "(2017) or the RepEval workshops."}, {"id": 111, "string": "2 We evaluate our learned representations with classification and similarity tasks from SentEval (Section 4.1) and by examining clusters of sentence paraphrase representations (Section 4.2)."}, {"id": 112, "string": "SentEval We perform evaluation on 10 classification and 7 similarity tasks using the SentEval 3 (Conneau et al., 2017) evaluation tool."}, {"id": 113, "string": "This is a superset of the tasks from Kiros et al."}, {"id": 114, "string": "(2015) ."}, {"id": 115, "string": "Table 2 describes the classification tasks (number of classes, data size, task type and an example) and Table 3 lists the similarity tasks."}, {"id": 116, "string": "The similarity (relatedness) datasets contain pairs of sentences labeled with a real-valued similarity score."}, {"id": 117, "string": "A given sentence representation model is evaluated either by learning to directly predict this score given the respective sentence embeddings (\"regression\"), or by computing the cosine similarity of the embeddings (\"similarity\") without the need of any training."}, {"id": 118, "string": "In both cases, Pearson and Spearman correlation of the predictions with the gold ratings is reported."}, {"id": 119, "string": "See Dolan et al."}, {"id": 120, "string": "(2004) for details on MRPC and Hill et al."}, {"id": 121, "string": "(2016) for the remaining tasks."}, {"id": 122, "string": "Paraphrases We also evaluate the representation of paraphrases."}, {"id": 123, "string": "We use two paraphrase sources for this purpose: COCO and HyTER Networks."}, {"id": 124, "string": "COCO (Common Objects in Context; Lin et al., 2014) is an object recognition and image captioning dataset, containing 5 captions for each image."}, {"id": 125, "string": "We extracted the captions from its validation set to form a set of 5 \u00d7 5k = 25k sentences grouped by the source image."}, {"id": 126, "string": "The average sentence length is 11 tokens and the vocabulary size is 9k types."}, {"id": 127, "string": "HyTER Networks (Dreyer and Marcu, 2014 ) are large finite-state networks representing a sub-set of all possible English translations of 102 Arabic and 102 Chinese sentences."}, {"id": 128, "string": "The networks were built by manually based on reference sentences in Arabic, Chinese and English."}, {"id": 129, "string": "Each network contains up to hundreds of thousands of possible translations of the given source sentence."}, {"id": 130, "string": "We randomly generated 500 translations for each source sentence, obtaining a corpus of 102k sentences grouped into 204 clusters, each containing 500 paraphrases."}, {"id": 131, "string": "The average length of the 102k English sentences is 28 tokens and the vocabulary size is 11k token types."}, {"id": 132, "string": "For every model, we encode each dataset to obtain a set of sentence embeddings with cluster labels."}, {"id": 133, "string": "We then compute the following metrics: Cluster classification accuracy (denoted \"Cl\")."}, {"id": 134, "string": "We remove 1 point (COCO) or half of the points (HyTER) from each cluster, and fit an LDA classifier on the rest."}, {"id": 135, "string": "We then compute the accuracy of the classifier on the removed points."}, {"id": 136, "string": "Nearest-neighbor paraphrase retrieval accuracy (NN)."}, {"id": 137, "string": "For each point, we find its nearest neighbor according to cosine or L 2 distance, and count how often the neighbor lies in the same cluster as the original point."}, {"id": 138, "string": "Inverse Davies-Bouldin index (iDB)."}, {"id": 139, "string": "The Davies-Bouldin index (Davies and Bouldin, 1979) measures cluster separation."}, {"id": 140, "string": "For every pair of clusters, we compute the ratio R ij of their combined scatter (average L 2 distance to the centroid) S i + S j and the L 2 distance of their centroids d ij , then average the maximum values for all clusters: R ij = S i + S j d ij (5) DB = 1 N N \ufffd i=1 max j\ufffd =i R ij (6) The lower the DB index, the better the separation."}, {"id": 141, "string": "To match with the rest of our metrics, we take its inverse: iDB = 1 DB ."}, {"id": 142, "string": "Experimental Results We trained English-to-German and English-to-Czech NMT models using Neural Monkey 4 (Helcl and Libovick\u00fd, 2017a) ."}, {"id": 143, "string": "In the following, we distinguish these models using the code of the target language, i.e."}, {"id": 144, "string": "de or cs."}, {"id": 145, "string": "The de models were trained on the Multi30K multilingual image caption dataset (Elliott et al., 4 https://github.com/ufal/neuralmonkey 2016), extended by Helcl and Libovick\u00fd (2017b) , who acquired additional parallel data using backtranslation (Sennrich et al., 2016) and perplexitybased selection (Yasuda et al., 2008) ."}, {"id": 146, "string": "This extended dataset contains 410k sentence pairs, with the average sentence length of 12 \u00b1 4 tokens in English."}, {"id": 147, "string": "We train each model for 20 epochs with the batch size of 32."}, {"id": 148, "string": "We truecased the training data as well as all data we evaluate on."}, {"id": 149, "string": "For German, we employed Neural Monkey's reversible pre-processing scheme, which expands contractions and performs morphological segmentation of determiners."}, {"id": 150, "string": "We used a vocabulary of at most 30k tokens for each language (no subword units)."}, {"id": 151, "string": "The cs models were trained on CzEng 1.7 (Bojar et al., 2016) ."}, {"id": 152, "string": "5 We used byte-pair encoding (BPE) with a vocabulary of 30k sub-word units, shared for both languages."}, {"id": 153, "string": "For English, the average sentence length is 15 \u00b1 19 BPE tokens and the original vocabulary size is 1.9M."}, {"id": 154, "string": "We performed 1 training epoch with the batch size of 128 on the entire training section (57M sentence pairs)."}, {"id": 155, "string": "The datasets for both de and cs models come with their respective development and test sets of sentence pairs, which we use for the evaluation of translation quality."}, {"id": 156, "string": "(We use 1k randomly selected sentence pairs from CzEng 1.7 dtest as a development set."}, {"id": 157, "string": "For evaluation, we use the entire etest.)"}, {"id": 158, "string": "We also evaluate the InferSent model 6 (Conneau et al., 2017) as pre-trained on the natural language inference (NLI) task."}, {"id": 159, "string": "InferSent has been shown to achieve state-of-the-art results on the SentEval tasks."}, {"id": 160, "string": "We also include a bag-ofwords baseline (GloVe-BOW) obtained by averaging GloVe 7 word vectors (Pennington et al., 2014) ."}, {"id": 161, "string": "Translation Quality We estimate translation quality of the various models using single-reference case-sensitive BLEU (Papineni et al., 2002) as implemented in Neural Monkey (the reference implementation is mteval-v13a.pl from NIST or Moses)."}, {"id": 162, "string": "Tables 4 and 5 provide the results on the two datasets."}, {"id": 163, "string": "The cs dataset is much larger and the training takes much longer."}, {"id": 164, "string": "We were thus able to experiment with only a subset of the possible model configurations."}, {"id": 165, "string": "Table 5 : Translation quality of cs models."}, {"id": 166, "string": "The columns \"Size\" and \"Heads\" specify the total size of sentence representation and the number of heads of encoder inner attention."}, {"id": 167, "string": "In both cases, the best performing is the ATTN Bahdanau et al."}, {"id": 168, "string": "model, followed by Transformer (de only) and our ATTN-ATTN (compound attention)."}, {"id": 169, "string": "The non-attentive FINAL Cho et al."}, {"id": 170, "string": "is the worst, except cs-MAXPOOL."}, {"id": 171, "string": "For 5 selected cs models, we also performed the WMT-style 5-way manual ranking on 200 sentence pairs."}, {"id": 172, "string": "The annotations are interpreted as simulated pairwise comparisons."}, {"id": 173, "string": "For each model, the final score is the number of times the model was judged better than the other model in the pair."}, {"id": 174, "string": "Tied pairs are excluded."}, {"id": 175, "string": "The results, shown in Table 5, confirm the automatic evaluation results."}, {"id": 176, "string": "We also checked the relation between BLEU and the number of heads and representation size."}, {"id": 177, "string": "While there are many exceptions, the general ten-dency is that the larger the representation or the more heads, the higher the BLEU score."}, {"id": 178, "string": "The Pearson correlation between BLEU and the number of heads is 0.87 for cs and 0.31 for de."}, {"id": 179, "string": "SentEval Due to the large number of SentEval tasks, we present the results abridged in two different ways: by reporting averages (Table 6 ) and by showing only the best models in comparison with other methods ( Table 7) ."}, {"id": 180, "string": "The full results can be found in the supplementary material."}, {"id": 181, "string": "Table 6 provides averages of the classification and similarity results, along with the results of selected tasks (SNLI, SICK-E)."}, {"id": 182, "string": "As the baseline for classifications tasks, we assign the most frequent class to all test examples."}, {"id": 183, "string": "8 The de models are generally worse, most likely due to the higher OOV rate and overall simplicity of the training sentences."}, {"id": 184, "string": "On cs, we see a clear pattern that more heads hurt the performance."}, {"id": 185, "string": "The de set has more variations to consider but the results are less conclusive."}, {"id": 186, "string": "For the similarity results, it is worth noting that cs-ATTN-ATTN performs very well with 1 attention head but fails miserably with more heads."}, {"id": 187, "string": "Otherwise, the relation to the number of heads is less clear."}, {"id": 188, "string": "Table 7 compares our strongest models with other approaches on all tasks."}, {"id": 189, "string": "Besides InferSent and GloVe-BOW, we include SkipThought as evaluated by Conneau et al."}, {"id": 190, "string": "(2017) , and the NMTbased embeddings by Hill et al."}, {"id": 191, "string": "(2016) trained on the English-French WMT15 dataset (this is the best result reported by Hill et al."}, {"id": 192, "string": "for NMT) ."}, {"id": 193, "string": "We see that the supervised InferSent clearly outperforms all other models in all tasks except for MRPC and TREC."}, {"id": 194, "string": "Results by Hill et al."}, {"id": 195, "string": "are always lower than our best setups, except MRPC and TREC again."}, {"id": 196, "string": "On classification tasks, our models are outperformed even by GloVe-BOW, except for the NLI tasks (SICK-E and SNLI) where cs-FINAL-CTX is better."}, {"id": 197, "string": "Table 6 : Abridged SentEval and paraphrase evaluation results."}, {"id": 198, "string": "Full results in supplementary material."}, {"id": 199, "string": "AvgAcc is the average of all 10 SentEval classification tasks (see Table S1 in supplementary material), AvgSim averages all 7 similarity tasks (see Table S2 )."}, {"id": 200, "string": "Hy-and CO-stand for HyTER and COCO, respectively."}, {"id": 201, "string": "\"H.\" is the number of attention heads."}, {"id": 202, "string": "We give the out-of-vocabulary (OOV) rate and the perplexity of a 4-gram language model (LM) trained on the English side of the respective parallel corpus and evaluated on all available data for a given task."}, {"id": 203, "string": "than L 2 distance."}, {"id": 204, "string": "We therefore do not list L 2based results (except in the supplementary material)."}, {"id": 205, "string": "This evaluation seems less stable and discerning than the previous two, but we can again confirm the victory of InferSent followed by our nonattentive cs models."}, {"id": 206, "string": "cs and de models are no longer clearly separated."}, {"id": 207, "string": "Paraphrase Scores Discussion To assess the relation between the various measures of sentence representations and translation quality as estimated by BLEU, we plot a heatmap of Pearson correlations in Fig."}, {"id": 208, "string": "2 ."}, {"id": 209, "string": "As one example, Fig."}, {"id": 210, "string": "3 details the cs models' BLEU scores and AvgAcc."}, {"id": 211, "string": "A good sign is that on the cs dataset, most metrics of representation are positively correlated (the pairwise Pearson correlation is 0.78 \u00b1 0.32 on average), the outlier being TREC (\u22120.16 \u00b1 0.16 correlation with the other metrics on average) On the other hand, most representation metrics correlate with BLEU negatively (\u22120.57\u00b10.31) on cs."}, {"id": 212, "string": "The pattern is less pronounced but still clear also on the de dataset."}, {"id": 213, "string": "A detailed understanding of what the learned representations contain is difficult."}, {"id": 214, "string": "We can only speculate that if the NMT model has some capability for following the source sentence superficially, it will use it and spend its capacity on closely matching the target sentences rather than on deriving some representation of meaning which would reflect e.g."}, {"id": 215, "string": "semantic similarity."}, {"id": 216, "string": "We assume that this can be a direct consequence of NMT being trained for cross entropy: putting the exact word forms in exact positions as the target sentence requires."}, {"id": 217, "string": "Performing well in single-reference BLEU is not an indication that the system understands the meaning but rather that it can maximize the chance of producing the n-grams required by the reference."}, {"id": 218, "string": "The negative correlation between the number of attention heads and the representation metrics from Fig."}, {"id": 219, "string": "3 (\u22120.81 \u00b1 0.12 for cs and \u22120.18 \u00b1 0.19 for de, on average) can be partly explained by the following observation."}, {"id": 220, "string": "We plotted the induced alignments (e.g."}, {"id": 221, "string": "Fig."}, {"id": 222, "string": "4 ) and noticed that the heads tend to \"divide\" the sentence into segments."}, {"id": 223, "string": "While one would hope that the segments correspond to some meaningful units of the sentence (e.g."}, {"id": 224, "string": "subject, predicate, object), we failed to find any such interpretation for ATTN-ATTN and for cs models in general."}, {"id": 225, "string": "Instead, the heads divide the source sentence more or less equidistantly, as documented by Fig."}, {"id": 226, "string": "5 ."}, {"id": 227, "string": "Such a multi-headed sentence representation is then less fit for representing e.g."}, {"id": 228, "string": "paraphrases where the subject and object swap their position due to passivization, because their representations are then accessed by different heads, and thus end up in different parts of the sentence embedding vector."}, {"id": 229, "string": "For de-ATTN-CTX models, we observed a much  flatter distribution of attention weights for each head and, unlike in the other models, we were often able to identify a head focusing on the main verb."}, {"id": 230, "string": "This difference between ATTN-ATTN and some ATTN-CTX models could be explained by the fact that in the former, the decoder is oblivious to the ordering of the heads (because of decoder attention), and hence it may not be useful for a given head to look for a specific syntactic or semantic role."}, {"id": 231, "string": "Conclusion We presented a novel variation of attentive NMT models Vaswani et al., 2017) that again provides a single meeting point with a continuous representation of the source sentence."}, {"id": 232, "string": "We evaluated these representations with a number of measures reflecting how well the meaning of the source sentence is captured."}, {"id": 233, "string": "While our proposed \"compound attention\" leads to translation quality not much worse than the fully attentive model, it generally does not perform well in the meaning representation."}, {"id": 234, "string": "Quite on the contrary, the better the BLEU score, the worse the meaning representation."}, {"id": 235, "string": "We believe that this observation is important for representation learning where bilingual MT now seems less likely to provide useful data, but perhaps more so for MT itself, where the struggle towards a high single-reference BLEU score (or even worse, cross entropy) leads to systems that refuse to consider the meaning of the sentence."}], "headers": [{"section": "Introduction", "n": "1", "start": 0, "end": 19}, {"section": "Related Work", "n": "2", "start": 20, "end": 39}, {"section": "Model Architectures", "n": "3", "start": 40, "end": 53}, {"section": "Compound Attention", "n": "3.1", "start": 54, "end": 96}, {"section": "Constant Context", "n": "3.2", "start": 97, "end": 100}, {"section": "Transformer with Inner Attention", "n": "3.3", "start": 101, "end": 106}, {"section": "Representation Evaluation", "n": "4", "start": 107, "end": 111}, {"section": "SentEval", "n": "4.1", "start": 112, "end": 121}, {"section": "Paraphrases", "n": "4.2", "start": 122, "end": 141}, {"section": "Experimental Results", "n": "5", "start": 142, "end": 160}, {"section": "Translation Quality", "n": "5.1", "start": 161, "end": 178}, {"section": "SentEval", "n": "5.2", "start": 179, "end": 206}, {"section": "Discussion", "n": "6", "start": 207, "end": 230}, {"section": "Conclusion", "n": "7", "start": 231, "end": 235}], "figures": [{"filename": "../figure/image/1292-Table4-1.png", "caption": "Table 4: Translation quality of de models.", "page": 5, "bbox": {"x1": 87.84, "x2": 274.08, "y1": 61.44, "y2": 312.96}}, {"filename": "../figure/image/1292-Table5-1.png", "caption": "Table 5: Translation quality of cs models.", "page": 5, "bbox": {"x1": 75.84, "x2": 287.03999999999996, "y1": 344.64, "y2": 466.08}}, {"filename": "../figure/image/1292-Table1-1.png", "caption": "Table 1: Different RNN-based architectures and their properties. Legend: \u201cpooling\u201d \u2013 vectors combined by mean or max (AVGPOOL, MAXPOOL); \u201csent. emb.\u201d \u2013 sentence embedding, i.e. the fixed-size sentence representation computed by the encoder. \u201cinit\u201d \u2013 initial decoder state. \u201cctx\u201d \u2013 context vector, i.e. input for the decoder cell. \u201cinput for att.\u201d \u2013 input for the decoder attention.", "page": 1, "bbox": {"x1": 76.8, "x2": 521.28, "y1": 65.75999999999999, "y2": 144.0}}, {"filename": "../figure/image/1292-Figure1-1.png", "caption": "Figure 1: An illustration of compound attention with 4 attention heads. The figure shows the computations that result in the decoder state s3 (in addition, each state si depends on the previous target token yi\u22121). Note that the matrix M is the same for all positions in the output sentence and it can thus serve as the source sentence representation.", "page": 1, "bbox": {"x1": 326.88, "x2": 504.47999999999996, "y1": 223.67999999999998, "y2": 447.35999999999996}}, {"filename": "../figure/image/1292-Table6-1.png", "caption": "Table 6: Abridged SentEval and paraphrase evaluation results. Full results in supplementary material. AvgAcc is the average of all 10 SentEval classification tasks (see Table S1 in supplementary material), AvgSim averages all 7 similarity tasks (see Table S2). Hy- and CO- stand for HyTER and COCO, respectively. \u201cH.\u201d is the number of attention heads. We give the out-of-vocabulary (OOV) rate and the perplexity of a 4-gram language model (LM) trained on the English side of the respective parallel corpus and evaluated on all available data for a given task.", "page": 6, "bbox": {"x1": 72.0, "x2": 526.0799999999999, "y1": 63.839999999999996, "y2": 420.0}}, {"filename": "../figure/image/1292-Table7-1.png", "caption": "Table 7: Comparison of state-of-the-art SentEval results with our best models and the Glove-BOW baseline. \u201cH.\u201d is the number of attention heads. Reprinted results are marked with \u2020, others are our measurements.", "page": 6, "bbox": {"x1": 72.0, "x2": 526.0799999999999, "y1": 515.52, "y2": 709.92}}, {"filename": "../figure/image/1292-Figure3-1.png", "caption": "Figure 3: BLEU vs. AvgAcc for cs models.", "page": 7, "bbox": {"x1": 311.52, "x2": 520.8, "y1": 69.6, "y2": 234.72}}, {"filename": "../figure/image/1292-Figure2-1.png", "caption": "Figure 2: Pearson correlations. Upper triangle: de models, lower triangle: cs models. Positive values shown in shades of green. For similarity tasks, only the Pearson (not Spearman) coefficient is represented.", "page": 7, "bbox": {"x1": 76.32, "x2": 286.08, "y1": 67.67999999999999, "y2": 289.44}}, {"filename": "../figure/image/1292-Table2-1.png", "caption": "Table 2: SentEval classification tasks. Tasks without a test set use 10-fold cross-validation.", "page": 3, "bbox": {"x1": 72.0, "x2": 526.0799999999999, "y1": 63.36, "y2": 223.2}}, {"filename": "../figure/image/1292-Table3-1.png", "caption": "Table 3: SentEval semantic relatedness tasks.", "page": 3, "bbox": {"x1": 94.56, "x2": 267.36, "y1": 262.08, "y2": 342.24}}, {"filename": "../figure/image/1292-Figure4-1.png", "caption": "Figure 4: Alignment between a source sentence (left) and the output (right) as represented in the ATTN-ATTN model with 8 heads and size of 1000. Each color represents a different head; the stroke width indicates the alignment weight; weights \u2264 0.01 pruned out. (Best viewed in color.)", "page": 8, "bbox": {"x1": 78.72, "x2": 283.68, "y1": 69.12, "y2": 406.08}}, {"filename": "../figure/image/1292-Figure5-1.png", "caption": "Figure 5: Attention weight by relative position in the source sentence (average over dev set excluding sentences shorter than 8 tokens). Same model as in Fig. 4. Each plot corresponds to one head.", "page": 8, "bbox": {"x1": 313.44, "x2": 517.92, "y1": 70.56, "y2": 264.48}}]}