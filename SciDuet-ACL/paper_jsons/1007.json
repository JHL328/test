{"title": "What you can cram into a single $&!#* vector: Probing sentence embeddings for linguistic properties", "abstract": "Although much effort has recently been devoted to training high-quality sentence embeddings, we still have a poor understanding of what they are capturing. \"Downstream\" tasks, often based on sentence classification, are commonly used to evaluate the quality of sentence representations. The complexity of the tasks makes it however difficult to infer what kind of information is present in the representations. We introduce here 10 probing tasks designed to capture simple linguistic features of sentences, and we use them to study embeddings generated by three different encoders trained in eight distinct ways, uncovering intriguing properties of both encoders and training methods.", "text": [{"id": 0, "string": "Introduction Despite Ray Mooney's quip that you cannot cram the meaning of a whole %&!$# sentence into a single $&!#* vector, sentence embedding methods have achieved impressive results in tasks ranging from machine translation (Sutskever et al., 2014; Cho et al., 2014) to entailment detection (Williams et al., 2018) , spurring the quest for \"universal embeddings\" trained once and used in a variety of applications (e.g., Conneau et al., 2017; Subramanian et al., 2018) ."}, {"id": 1, "string": "Positive results on concrete problems suggest that embeddings capture important linguistic properties of sentences."}, {"id": 2, "string": "However, real-life \"downstream\" tasks require complex forms of inference, making it difficult to pinpoint the information a model is relying upon."}, {"id": 3, "string": "Impressive as it might be that a system can tell that the sentence \"A movie that doesn't aim too high, but it doesn't need to\" (Pang and Lee, 2004 ) expresses a subjective viewpoint, it is hard to tell how the system (or even a human) comes to this conclusion."}, {"id": 4, "string": "Complex tasks can also carry hidden biases that models might lock onto (Jabri et al., 2016) ."}, {"id": 5, "string": "For example, Lai and Hockenmaier (2014) show that the simple heuristic of checking for explicit negation words leads to good accuracy in the SICK sentence entailment task."}, {"id": 6, "string": "Model introspection techniques have been applied to sentence encoders in order to gain a better understanding of which properties of the input sentences their embeddings retain (see Section 5)."}, {"id": 7, "string": "However, these techniques often depend on the specifics of an encoder architecture, and consequently cannot be used to compare different methods."}, {"id": 8, "string": "Shi et al."}, {"id": 9, "string": "(2016) and Adi et al."}, {"id": 10, "string": "(2017) introduced a more general approach, relying on the notion of what we will call probing tasks."}, {"id": 11, "string": "A probing task is a classification problem that focuses on simple linguistic properties of sentences."}, {"id": 12, "string": "For example, one such task might require to categorize sentences by the tense of their main verb."}, {"id": 13, "string": "Given an encoder (e.g., an LSTM) pre-trained on a certain task (e.g., machine translation), we use the sentence embeddings it produces to train the tense classifier (without further embedding tuning)."}, {"id": 14, "string": "If the classifier succeeds, it means that the pre-trained encoder is storing readable tense information into the embeddings it creates."}, {"id": 15, "string": "Note that: (i) The probing task asks a simple question, minimizing interpretability problems."}, {"id": 16, "string": "(ii) Because of their simplicity, it is easier to control for biases in probing tasks than in downstream tasks."}, {"id": 17, "string": "(iii) The probing task methodology is agnostic with respect to the encoder architecture, as long as it produces a vector representation of sentences."}, {"id": 18, "string": "We greatly extend earlier work on probing tasks as follows."}, {"id": 19, "string": "First, we introduce a larger set of probing tasks (10 in total), organized by the type of linguistic properties they probe."}, {"id": 20, "string": "Second, we systematize the probing task methodology, controlling for a number of possible nuisance factors, and framing all tasks so that they only require single sentence representations as input, for maximum generality and to ease result interpretation."}, {"id": 21, "string": "Third, we use our probing tasks to explore a wide range of state-of-the-art encoding architectures and training methods, and further relate probing and downstream task performance."}, {"id": 22, "string": "Finally, we are publicly releasing our probing data sets and tools, hoping they will become a standard way to study the linguistic properties of sentence embeddings."}, {"id": 23, "string": "1 Probing tasks In constructing our probing benchmarks, we adopted the following criteria."}, {"id": 24, "string": "First, for generality and interpretability, the task classification problem should only require single sentence embeddings as input (as opposed to, e.g., sentence and word embeddings, or multiple sentence representations)."}, {"id": 25, "string": "Second, it should be possible to construct large training sets in order to train parameter-rich multi-layer classifiers, in case the relevant properties are non-linearly encoded in the sentence vectors."}, {"id": 26, "string": "Third, nuisance variables such as lexical cues or sentence length should be controlled for."}, {"id": 27, "string": "Finally, and most importantly, we want tasks that address an interesting set of linguistic properties."}, {"id": 28, "string": "We thus strove to come up with a set of tasks that, while respecting the previous constraints, probe a wide range of phenomena, from superficial properties of sentences such as which words they contain to their hierarchical structure to subtle facets of semantic acceptability."}, {"id": 29, "string": "We think the current task set is reasonably representative of different linguistic domains, but we are not claiming that it is exhaustive."}, {"id": 30, "string": "We expect future work to extend it."}, {"id": 31, "string": "The sentences for all our tasks are extracted from the Toronto Book Corpus , more specifically from the random pre-processed portion made available by Paperno et al."}, {"id": 32, "string": "(2016) ."}, {"id": 33, "string": "We only sample sentences in the 5-to-28 word range."}, {"id": 34, "string": "We parse them with the Stanford Parser (2017-06-09 version), using the pre-trained PCFG model (Klein and Manning, 2003) , and we rely on the part-of-speech, constituency and dependency parsing information provided by this tool where needed."}, {"id": 35, "string": "For each task, we construct training sets containing 100k sentences, and 10k-sentence val-idation and test sets."}, {"id": 36, "string": "All sets are balanced, having an equal number of instances of each target class."}, {"id": 37, "string": "Surface information These tasks test the extent to which sentence embeddings are preserving surface properties of the sentences they encode."}, {"id": 38, "string": "One can solve the surface tasks by simply looking at tokens in the input sentences: no linguistic knowledge is called for."}, {"id": 39, "string": "The first task is to predict the length of sentences in terms of number of words (SentLen)."}, {"id": 40, "string": "Following Adi et al."}, {"id": 41, "string": "(2017) , we group sentences into 6 equal-width bins by length, and treat SentLen as a 6-way classification task."}, {"id": 42, "string": "The word content (WC) task tests whether it is possible to recover information about the original words in the sentence from its embedding."}, {"id": 43, "string": "We picked 1000 mid-frequency words from the source corpus vocabulary (the words with ranks between 2k and 3k when sorted by frequency), and sampled equal numbers of sentences that contain one and only one of these words."}, {"id": 44, "string": "The task is to tell which of the 1k words a sentence contains (1k-way classification)."}, {"id": 45, "string": "This setup allows us to probe a sentence embedding for word content without requiring an auxiliary word embedding (as in the setup of Adi and colleagues)."}, {"id": 46, "string": "Syntactic information The next batch of tasks test whether sentence embeddings are sensitive to syntactic properties of the sentences they encode."}, {"id": 47, "string": "The bigram shift (BShift) task tests whether an encoder is sensitive to legal word orders."}, {"id": 48, "string": "In this binary classification problem, models must distinguish intact sentences sampled from the corpus from sentences where we inverted two random adjacent words (\"What you are doing out there?\")."}, {"id": 49, "string": "The tree depth (TreeDepth) task checks whether an encoder infers the hierarchical structure of sentences, and in particular whether it can group sentences by the depth of the longest path from root to any leaf."}, {"id": 50, "string": "Since tree depth is naturally correlated with sentence length, we de-correlate these variables through a structured sampling procedure."}, {"id": 51, "string": "In the resulting data set, tree depth values range from 5 to 12, and the task is to categorize sentences into the class corresponding to their depth (8 classes)."}, {"id": 52, "string": "As an example, the following is a long (22 tokens) but shallow (max depth: 5) sentence: \"[ 1 [ 2 But right now, for the time being, my past, my fears, and my thoughts [ 3 were [ 4 my [ 5 business]]].]]\""}, {"id": 53, "string": "(the outermost brackets correspond to the ROOT and S nodes in the parse)."}, {"id": 54, "string": "In the top constituent task (TopConst), sentences must be classified in terms of the sequence of top constituents immediately below the sentence (S) node."}, {"id": 55, "string": "An encoder that successfully addresses this challenge is not only capturing latent syntactic structures, but clustering them by constituent types."}, {"id": 56, "string": "TopConst was introduced by Shi et al."}, {"id": 57, "string": "(2016) ."}, {"id": 58, "string": "Following them, we frame it as a 20-way classification problem: 19 classes for the most frequent top constructions, and one for all other constructions."}, {"id": 59, "string": "As an example, \"[Then] [very dark gray letters on a black screen] [appeared] [.]\""}, {"id": 60, "string": "has top constituent sequence: \"ADVP NP VP .\"."}, {"id": 61, "string": "Note that, while we would not expect an untrained human subject to be explicitly aware of tree depth or top constituency, similar information must be implicitly computed to correctly parse sentences, and there is suggestive evidence that the brain tracks something akin to tree depth during sentence processing (Nelson et al., 2017) ."}, {"id": 62, "string": "Semantic information These tasks also rely on syntactic structure, but they further require some understanding of what a sentence denotes."}, {"id": 63, "string": "The Tense task asks for the tense of the main-clause verb (VBP/VBZ forms are labeled as present, VBD as past)."}, {"id": 64, "string": "No target form occurs across the train/dev/test split, so that classifiers cannot rely on specific words (it is not clear that Shi and colleagues, who introduced this task, controlled for this factor)."}, {"id": 65, "string": "The subject number (SubjNum) task focuses on the number of the subject of the main clause (number in English is more often explicitly marked on nouns than verbs)."}, {"id": 66, "string": "Again, there is no target overlap across partitions."}, {"id": 67, "string": "Similarly, object number (ObjNum) tests for the number of the direct object of the main clause (again, avoiding lexical overlap)."}, {"id": 68, "string": "To solve the previous tasks correctly, an encoder must not only capture tense and number, but also extract structural information (about the main clause and its arguments)."}, {"id": 69, "string": "We grouped Tense, SubjNum and ObjNum with the semantic tasks, since, at least for models that treat words as unanalyzed input units (without access to morphology), they must rely on what a sentence denotes (e.g., whether the described event took place in the past), rather than on structural/syntactic information."}, {"id": 70, "string": "We recognize, however, that the boundary between syntactic and semantic tasks is somewhat arbitrary."}, {"id": 71, "string": "In the semantic odd man out (SOMO) task, we modified sentences by replacing a random noun or verb o with another noun or verb r. To make the task more challenging, the bigrams formed by the replacement with the previous and following words in the sentence have frequencies that are comparable (on a log-scale) with those of the original bigrams."}, {"id": 72, "string": "That is, if the original sentence contains bigrams w n\u22121 o and ow n+1 , the corresponding bigrams w n\u22121 r and rw n+1 in the modified sentence will have comparable corpus frequencies."}, {"id": 73, "string": "No sentence is included in both original and modified format, and no replacement is repeated across train/dev/test sets."}, {"id": 74, "string": "The task of the classifier is to tell whether a sentence has been modified or not."}, {"id": 75, "string": "An example modified sentence is: \" No one could see this Hayes and I wanted to know if it was real or a spoonful (orig."}, {"id": 76, "string": ": ploy).\""}, {"id": 77, "string": "Note that judging plausibility of a syntactically well-formed sentence of this sort will often require grasping rather subtle semantic factors, ranging from selectional preference to topical coherence."}, {"id": 78, "string": "The coordination inversion (CoordInv) benchmark contains sentences made of two coordinate clauses."}, {"id": 79, "string": "In half of the sentences, we inverted the order of the clauses."}, {"id": 80, "string": "The task is to tell whether a sentence is intact or modified."}, {"id": 81, "string": "Sentences are balanced in terms of clause length, and no sentence appears in both original and inverted versions."}, {"id": 82, "string": "As an example, original \"They might be only memories, but I can still feel each one\" becomes: \"I can still feel each one, but they might be only memories.\""}, {"id": 83, "string": "Often, addressing CoordInv requires an understanding of broad discourse and pragmatic factors."}, {"id": 84, "string": "Row Hum."}, {"id": 85, "string": "Eval."}, {"id": 86, "string": "of Table 2 reports humanvalidated \"reasonable\" upper bounds for all the tasks, estimated in different ways, depending on the tasks."}, {"id": 87, "string": "For the surface ones, there is always a straightforward correct answer that a human annotator with enough time and patience could find."}, {"id": 88, "string": "The upper bound is thus estimated at 100%."}, {"id": 89, "string": "The TreeDepth, TopConst, Tense, SubjNum and Ob-jNum tasks depend on automated PoS and parsing annotation."}, {"id": 90, "string": "In these cases, the upper bound is given by the proportion of sentences correctly annotated by the automated procedure."}, {"id": 91, "string": "To estimate this quantity, one linguistically-trained author checked the annotation of 200 randomly sampled test sentences from each task."}, {"id": 92, "string": "Finally, the BShift, SOMO and CoordInv manipulations can accidentally generate acceptable sentences."}, {"id": 93, "string": "For example, one modified SOMO sentence is: \"He pulled out the large round onion (orig."}, {"id": 94, "string": ": cork) and saw the amber balm inside."}, {"id": 95, "string": "\", that is arguably not more anomalous than the original."}, {"id": 96, "string": "For these tasks, we ran Amazon Mechanical Turk experiments in which subjects were asked to judge whether 1k randomly sampled test sentences were acceptable or not."}, {"id": 97, "string": "Reported human accuracies are based on majority voting."}, {"id": 98, "string": "See Appendix for details."}, {"id": 99, "string": "Sentence embedding models In this section, we present the three sentence encoders that we consider and the seven tasks on which we train them."}, {"id": 100, "string": "Sentence encoder architectures A wide variety of neural networks encoding sentences into fixed-size representations exist."}, {"id": 101, "string": "We focus here on three that have been shown to perform well on standard NLP tasks."}, {"id": 102, "string": "BiLSTM-last/max For a sequence of T words {w t } t=1,...,T , a bidirectional LSTM computes a set of T vectors {h t } t ."}, {"id": 103, "string": "For t \u2208 [1, ."}, {"id": 104, "string": "."}, {"id": 105, "string": "."}, {"id": 106, "string": ", T ] , h t is the concatenation of a forward LSTM and a backward LSTM that read the sentences in two opposite directions."}, {"id": 107, "string": "We experiment with two ways of combining the varying number of (h 1 , ."}, {"id": 108, "string": "."}, {"id": 109, "string": "."}, {"id": 110, "string": ", h T ) to form a fixed-size vector, either by selecting the last hidden state of h T or by selecting the maximum value over each dimension of the hidden units."}, {"id": 111, "string": "The choice of these models are motivated by their demonstrated efficiency in seq2seq (Sutskever et al., 2014) and universal sentence representation learning (Conneau et al., 2017) , respectively."}, {"id": 112, "string": "2 Gated ConvNet We also consider the nonrecurrent convolutional equivalent of LSTMs, based on stacked gated temporal convolutions."}, {"id": 113, "string": "Gated convolutional networks were shown to perform well as neural machine translation encoders (Gehring et al., 2017) and language modeling decoders (Dauphin et al., 2017) ."}, {"id": 114, "string": "The encoder is composed of an input word embedding table that is augmented with positional encodings (Sukhbaatar et al., 2015) , followed by a stack of temporal convolutions with small kernel size."}, {"id": 115, "string": "The output of each convolutional layer is filtered by a gating mechanism, similar to the one of LSTMs."}, {"id": 116, "string": "Finally, max-pooling along the temporal dimension is performed on the output feature maps of the last convolution (Collobert and Weston, 2008) ."}, {"id": 117, "string": "Training tasks Seq2seq systems have shown strong results in machine translation (Zhou et al., 2016) ."}, {"id": 118, "string": "They consist of an encoder that encodes a source sentence into a fixed-size representation, and a decoder which acts as a conditional language model and that generates the target sentence."}, {"id": 119, "string": "We train Neural Machine Translation systems on three language pairs using about 2M sentences from the Europarl corpora (Koehn, 2005) ."}, {"id": 120, "string": "We pick English-French, which involves two similar languages, English-German, involving larger syntactic differences, and English-Finnish, a distant pair."}, {"id": 121, "string": "We also train with an AutoEncoder objective (Socher et al., 2011) on Europarl source English sentences."}, {"id": 122, "string": "Following Vinyals et al."}, {"id": 123, "string": "(2015) , we train a seq2seq architecture to generate linearized grammatical parse trees (see Table 1 ) from source sentences (Seq2Tree)."}, {"id": 124, "string": "We use the Stanford parser to generate trees for Europarl source English sentences."}, {"id": 125, "string": "We train SkipThought vectors  by predicting the next sentence given the current one (Tang et al., 2017) , on 30M sentences from the Toronto Book Corpus, excluding those in the probing sets."}, {"id": 126, "string": "Finally, following Conneau et al."}, {"id": 127, "string": "(2017) , we train sentence encoders on Natural Language Inference using the concatenation of the SNLI (Bowman et al., 2015) and MultiNLI (Bowman et al., 2015) data sets (about 1M sentence pairs)."}, {"id": 128, "string": "In this task, a sentence encoder is trained to encode two sentences, which are fed to a classifier and whose role is to distinguish whether the sentences are contradictory, neutral or entailed."}, {"id": 129, "string": "Finally, as in Conneau et al."}, {"id": 130, "string": "(2017) , we also include Untrained encoders with random weights, which act as random projections of pre-trained word embeddings."}, {"id": 131, "string": "Training details BiLSTM encoders use 2 layers of 512 hidden units (\u223c4M parameters), Gated ConvNet has 8 convolutional layers of 512 hidden units, kernel size 3 (\u223c12M parameters)."}, {"id": 132, "string": "We use pre-trained fast-Text word embeddings of size 300 (Mikolov et al., 2018) without fine-tuning, to isolate the impact of encoder architectures and to handle words outside the training sets."}, {"id": 133, "string": "Training task performance and further details are in Appendix."}, {"id": 134, "string": "task source target AutoEncoder I myself was out on an island in the Swedish archipelago , at Sandhamn ."}, {"id": 135, "string": "I myself was out on an island in the Swedish archipelago , at Sand@ ham@ n ."}, {"id": 136, "string": "NMT En-Fr I myself was out on an island in the Swedish archipelago , at Sandhamn ."}, {"id": 137, "string": "Je me trouvais ce jour l\u00e0 sur une \u00eele de l' archipel su\u00e9dois , \u00e0 Sand@ ham@ n ."}, {"id": 138, "string": "NMT En-De We really need to up our particular contribution in that regard ."}, {"id": 139, "string": "Wir m\u00fcssen wirklich unsere spezielle Hilfs@ leistung in dieser Hinsicht aufstocken ."}, {"id": 140, "string": "NMT En-Fi It is too early to see one system as a universal panacea and dismiss another ."}, {"id": 141, "string": "Nyt on liian aikaista nostaa yksi j\u00e4rjestelm\u00e4 jal@ usta@ lle ja antaa jollekin toiselle huono arvo@ sana ."}, {"id": 142, "string": "SkipThought the old sami was gone , and he was a different person now ."}, {"id": 143, "string": "the new sami didn 't mind standing barefoot in dirty white , sans ra@ y-@ bans and without beautiful women following his every move ."}, {"id": 144, "string": "Seq2Tree Dikoya is a village in Sri Lanka ."}, {"id": 145, "string": "( ROOT ( S ( NP NNP ) NP ( VP VBZ ( NP ( NP DT NN ) NP ( PP IN ( NP NNP NNP ) NP ) PP ) NP ) VP . )"}, {"id": 146, "string": "S ) ROOT Probing task experiments Baselines Baseline and human-bound performance are reported in the top block of Table 2 ."}, {"id": 147, "string": "Length is a linear classifier with sentence length as sole feature."}, {"id": 148, "string": "NB-uni-tfidf is a Naive Bayes classifier using words' tfidf scores as features, NBbi-tfidf its extension to bigrams."}, {"id": 149, "string": "Finally, BoV-fastText derives sentence representations by averaging the fastText embeddings of the words they contain (same embeddings used as input to the encoders)."}, {"id": 150, "string": "3 Except, trivially, for Length on SentLen and the NB baselines on WC, there is a healthy gap between top baseline performance and human upper bounds."}, {"id": 151, "string": "NB-uni-tfidf evaluates to what extent our tasks can be addressed solely based on knowledge about the distribution of words in the training sentences."}, {"id": 152, "string": "Words are of course to some extent informative for most tasks, leading to relatively high performance in Tense, SubjNum and Ob-jNum."}, {"id": 153, "string": "Recall that the words containing the probed features are disjoint between train and test partitions, so we are not observing a confound here, but rather the effect of the redundancies one expects in natural language data."}, {"id": 154, "string": "For example, for Tense, since sentences often contain more than one verb in the same tense, NB-uni-tfidf can exploit nontarget verbs as cues: the NB features most associated to the past class are verbs in the past tense (e.g \"sensed\", \"lied\", \"announced\"), and similarly for present (e.g \"uses\", \"chuckles\", \"frowns\")."}, {"id": 155, "string": "Using bigram features (NB-bi-tfidf) brings in general little or no improvement with respect to the unigram baseline, except, trivially, for the BShift 3 Similar results are obtained summing embeddings, and using GloVe embeddings (Pennington et al., 2014) ."}, {"id": 156, "string": "task, where NB-bi-tfidf can easily detect unlikely bigrams."}, {"id": 157, "string": "NB-bi-tfidf has below-random performance on SOMO, confirming that the semantic intruder is not given away by superficial bigram cues."}, {"id": 158, "string": "Our first striking result is the good overall performance of Bag-of-Vectors, confirming early insights that aggregated word embeddings capture surprising amounts of sentence information (Pham et al., 2015; Arora et al., 2017; Adi et al., 2017) ."}, {"id": 159, "string": "BoV's good WC and SentLen performance was already established by Adi et al."}, {"id": 160, "string": "(2017) ."}, {"id": 161, "string": "Not surprisingly, word-order-unaware BoV performs randomly in BShift and in the more sophisticated semantic tasks SOMO and CoordInv."}, {"id": 162, "string": "More interestingly, BoV is very good at the Tense, SubjNum, ObjNum, and TopConst tasks (much better than the word-based baselines), and well above chance in TreeDepth."}, {"id": 163, "string": "The good performance on Tense, SubjNum and ObjNum has a straightforward explanation we have already hinted at above."}, {"id": 164, "string": "Many sentences are naturally \"redundant\", in the sense that most tensed verbs in a sentence are in the same tense, and similarly for number in nouns."}, {"id": 165, "string": "In 95.2% Tense, 75.9% SubjNum and 78.7% Ob-jNum test sentences, the target tense/number feature is also the majority one for the whole sentence."}, {"id": 166, "string": "Word embeddings capture features such as number and tense (Mikolov et al., 2013) , so aggregated word embeddings will naturally track these features' majority values in a sentence."}, {"id": 167, "string": "BoV's TopConst and TreeDepth performance is more surprising."}, {"id": 168, "string": "Accuracy is well above NB, showing that BoV is exploiting cues beyond specific words strongly associated to the target classes."}, {"id": 169, "string": "We conjecture that more abstract word features captured  by the embeddings (such as the part of speech of a word) might signal different syntactic structures."}, {"id": 170, "string": "For example, sentences in the \"WHNP SQ .\""}, {"id": 171, "string": "top constituent class (e.g., \"How long before you leave us again?\")"}, {"id": 172, "string": "must contain a wh word, and will often feature an auxiliary or modal verb."}, {"id": 173, "string": "BoV can rely on this information to noisily predict the correct class."}, {"id": 174, "string": "Encoding architectures Comfortingly, proper encoding architectures clearly outperform BoV."}, {"id": 175, "string": "An interesting observation in Table 2 is that different encoder architectures trained with the same objective, and achieving similar performance on the training task, 4 can lead to linguistically different embeddings, as indicated by the probing tasks."}, {"id": 176, "string": "Coherently with the findings of Conneau et al."}, {"id": 177, "string": "(2017) for the downstream tasks, this sug-4 See Appendix for details on training task performance."}, {"id": 178, "string": "gests that the prior imposed by the encoder architecture strongly preconditions the nature of the embeddings."}, {"id": 179, "string": "Complementing recent evidence that convolutional architectures are on a par with recurrent ones in seq2seq tasks (Gehring et al., 2017) , we find that Gated ConvNet's overall probing task performance is comparable to that of the best LSTM architecture (although, as shown in Appendix, the LSTM has a slight edge on downstream tasks)."}, {"id": 180, "string": "We also replicate the finding of Conneau et al."}, {"id": 181, "string": "(2017) that BiLSTM-max outperforms BiLSTM-last both in the downstream tasks (see Appendix) and in the probing tasks (Table 2) ."}, {"id": 182, "string": "Interestingly, the latter only outperforms the former in SentLen, a task that captures a superficial aspect of sentences (how many words they contain), that could get in the way of inducing more useful linguistic knowledge."}, {"id": 183, "string": "Training tasks We focus next on how different training tasks affect BiLSTM-max, but the patterns are generally representative across architectures."}, {"id": 184, "string": "NMT training leads to encoders that are more linguistically aware than those trained on the NLI data set, despite the fact that we confirm the finding of Conneau and colleagues that NLI is best for downstream tasks (Appendix)."}, {"id": 185, "string": "Perhaps, NMT captures richer linguistic features useful for the probing tasks, whereas shallower or more adhoc features might help more in our current downstream tasks."}, {"id": 186, "string": "Suggestively, the one task where NLI clearly outperforms NMT is WC."}, {"id": 187, "string": "Thus, NLI training is better at preserving shallower word features that might be more useful in downstream tasks (cf."}, {"id": 188, "string": "Figure 2 and discussion there)."}, {"id": 189, "string": "Unsupervised training (SkipThought and Au-toEncoder) is not on a par with supervised tasks, but still effective."}, {"id": 190, "string": "AutoEncoder training leads, unsurprisingly, to a model excelling at SentLen, but it attains low performance in the WC prediction task."}, {"id": 191, "string": "This curious result might indicate that the latter information is stored in the embeddings in a complex way, not easily readable by our MLP."}, {"id": 192, "string": "At the other end, Seq2Tree is trained to predict annotation from the same parser we used to create some of the probing tasks."}, {"id": 193, "string": "Thus, its high performance on TopConst, Tense, SubjNum, ObjNum and TreeDepth is probably an artifact."}, {"id": 194, "string": "Indeed, for most of these tasks, Seq2Tree performance is above the human bound, that is, Seq2Tree learned to mimic the parser errors in our benchmarks."}, {"id": 195, "string": "For the more challenging SOMO and CoordInv tasks, that only indirectly rely on tagging/parsing information, Seq2Tree is comparable to NMT, that does not use explicit syntactic information."}, {"id": 196, "string": "Perhaps most interestingly, BiLSTM-max already achieves very good performance without any training (Untrained row in Table 2 )."}, {"id": 197, "string": "Untrained BiLSTM-max also performs quite well in the downstream tasks (Appendix)."}, {"id": 198, "string": "This architecture must encode priors that are intrinsically good for sentence representations."}, {"id": 199, "string": "Untrained BiLSTM-max exploits the input fastText embeddings, and multiplying the latter by a random recurrent matrix provides a form of positional encoding."}, {"id": 200, "string": "However, good performance in a task such as SOMO, where BoV fails and positional information alone should not help (the intruder is randomly distributed across the sentence), suggests that other architectural biases are at work."}, {"id": 201, "string": "In-triguingly, a preliminary comparison of untrained BiLSTM-max and human subjects on the SOMO sentences evaluated by both reveals that, whereas humans have a bias towards finding sentences acceptable (62% sentences are rated as untampered with, vs. 48% ground-truth proportion), the model has a strong bias in the opposite direction (it rates 83% of the sentences as modified)."}, {"id": 202, "string": "A cursory look at contrasting errors confirms, unsurprisingly, that those made by humans are perfectly justified, while model errors are opaque."}, {"id": 203, "string": "For example, the sentence \"I didn't come here to reunite (orig."}, {"id": 204, "string": "undermine) you\" seems perfectly acceptable in its modified form, and indeed subjects judged it as such, whereas untrained BiLSTM-max \"correctly\" rated it as a modified item."}, {"id": 205, "string": "Conversely, it is difficult to see any clear reason for the latter tendency to rate perfectly acceptable originals as modified."}, {"id": 206, "string": "We leave a more thorough investigation to further work."}, {"id": 207, "string": "See similar observations on the effectiveness of untrained ConvNets in vision by Ulyanov et al."}, {"id": 208, "string": "(2017) ."}, {"id": 209, "string": "Probing task comparison A good encoder, such as NMT-trained BiLSTM-max, shows generally good performance across probing tasks."}, {"id": 210, "string": "At one extreme, performance is not particularly high on the surface tasks, which might be an indirect sign of the encoder extracting \"deeper\" linguistic properties."}, {"id": 211, "string": "At the other end, performance is still far from the human bounds on TreeDepth, BShift, SOMO and CoordInv."}, {"id": 212, "string": "The last 3 tasks ask if a sentence is syntactically or semantically anomalous."}, {"id": 213, "string": "This is a daunting job for an encoder that has not been explicitly trained on acceptability, and it is interesting that the best models are, at least to a certain extent, able to produce reasonable anomaly judgments."}, {"id": 214, "string": "The asymmetry between the difficult TreeDepth and easier TopConst is also interesting."}, {"id": 215, "string": "Intuitively, TreeDepth requires more nuanced syntactic information (down to the deepest leaf of the tree) than TopConst, that only requires identifying broad chunks."}, {"id": 216, "string": "Figure 1 reports how probing task accuracy changes in function of encoder training epochs."}, {"id": 217, "string": "The figure shows that NMT probing performance is largely independent of target language, with strikingly similar development patterns across French, German and Finnish."}, {"id": 218, "string": "Note in particular the similar probing accuracy curves in French and Finnish, while the corresponding BLEU scores (in lavender) are consistently higher in the former lan- guage."}, {"id": 219, "string": "For both NMT and SkipThought, WC performance keeps increasing with epochs."}, {"id": 220, "string": "For the other tasks, we observe instead an early flattening of the NMT probing curves, while BLEU performance keeps increasing."}, {"id": 221, "string": "Most strikingly, SentLen performance is actually decreasing, suggesting again that, as a model captures deeper linguistic properties, it will tend to forget about this superficial feature."}, {"id": 222, "string": "Finally, for the challenging SOMO task, the curves are mostly flat, suggesting that what BiLSTM-max is able to capture about this task is already encoded in its architecture, and further training doesn't help much."}, {"id": 223, "string": "Probing vs. downstream tasks Figure 2 reports correlation between performance on our probing tasks and the downstream tasks available in the SentEval 5 suite, which consists of classification (MR, CR, SUBJ, MPQA, SST2, SST5, TREC), natural language inference (SICK-E), semantic relatedness (SICK-R, STSB), paraphrase detection (MRPC) and semantic textual similarity (STS 2012 to 2017) tasks."}, {"id": 224, "string": "Strikingly, WC is significantly positively correlated with all downstream tasks."}, {"id": 225, "string": "This suggests that, at least for current models, the latter do not require extracting particularly abstract knowledge from the data."}, {"id": 226, "string": "Just relying on the words contained in the input sentences can get you a long way."}, {"id": 227, "string": "Conversely, there is a significant negative correlation between SentLen and most downstream tasks."}, {"id": 228, "string": "The number of words in a sentence is not informative about its linguistic contents."}, {"id": 229, "string": "The more models abstract away from such information, the more likely it is they will use their capacity to capture more interesting features, as the decrease of the SentLen curve along training (see Figure 1 ) also suggests."}, {"id": 230, "string": "Co-ordInv and, especially, SOMO, the tasks requiring the most sophisticated semantic knowledge, are those that positively correlate with the largest number of downstream tasks after WC."}, {"id": 231, "string": "We observe intriguing asymmetries: SOMO correlates with the SICK-E sentence entailment test, but not with SICK-R, which is about modeling sentence relatedness intuitions."}, {"id": 232, "string": "Indeed, logical entailment requires deeper semantic analysis than modeling similarity judgments."}, {"id": 233, "string": "TopConst and the number tasks negatively correlate with various similarity and sentiment data sets (SST, STS, SICK-R)."}, {"id": 234, "string": "This might expose biases in these tasks: SICK-R, for example, deliberately contains sentence pairs with opposite voice, that will have different constituent structure but equal meaning (Marelli et al., 2014) ."}, {"id": 235, "string": "It might also mirrors genuine factors affecting similarity judgments (e.g., two sentences differing only in object number are very similar)."}, {"id": 236, "string": "Remarkably, TREC question type classification is the downstream task correlating with most probing tasks."}, {"id": 237, "string": "Question classification is certainly an outlier among our downstream tasks, but we must leave a full understanding of this behaviour to future work (this is exactly the sort of analysis our probing tasks should stimulate)."}, {"id": 238, "string": "Adi et al."}, {"id": 239, "string": "(2017) introduced SentLen, WC and a word order test, focusing on a bag-of-vectors baseline, an autoencoder and skip-thought (all trained on the same data used for the probing tasks)."}, {"id": 240, "string": "We recast their tasks so that they only require a sentence embedding as input (two of their tasks also require word embeddings, polluting sentencelevel evaluation), we extend the evaluation to more tasks, encoders and training objectives, and we relate performance on the probing tasks with that on downstream tasks."}, {"id": 241, "string": "Shi et al."}, {"id": 242, "string": "(2016) also use 3 probing tasks, including Tense and TopConst."}, {"id": 243, "string": "It is not clear that they controlled for the same factors we considered (in particular, lexical overlap and Figure 2 : Spearman correlation matrix between probing and downstream tasks."}, {"id": 244, "string": "Correlations based on all sentence embeddings we investigated (more than 40)."}, {"id": 245, "string": "Cells in gray denote task pairs that are not significantly correlated (after correcting for multiple comparisons)."}, {"id": 246, "string": "Related work sentence length), and they use much smaller training sets, limiting classifier-based evaluation to logistic regression."}, {"id": 247, "string": "Moreover, they test a smaller set of models, focusing on machine translation."}, {"id": 248, "string": "Belinkov et al."}, {"id": 249, "string": "(2017a) , Belinkov et al."}, {"id": 250, "string": "(2017b) and Dalvi et al."}, {"id": 251, "string": "(2017) are also interested in understanding the type of linguistic knowledge encoded in sentence and word embeddings, but their focus is on word-level morphosyntax and lexical semantics, and specifically on NMT encoders and decoders."}, {"id": 252, "string": "Sennrich (2017) also focuses on NMT systems, and proposes a contrastive test to assess how they handle various linguistic phenomena."}, {"id": 253, "string": "Other work explores the linguistic behaviour of recurrent networks and related models by using visualization, input/hidden representation deletion techniques or by looking at the word-by-word behaviour of the network (e.g., Nagamine et al., 2015; Hupkes et al., 2017; Linzen et al., 2016; K\u00e0d\u00e0r et al., 2017; Li et al., 2017) ."}, {"id": 254, "string": "These methods, complementary to ours, are not agnostic to encoder architecture, and cannot be used for general-purpose cross-model evaluation."}, {"id": 255, "string": "Finally, Conneau et al."}, {"id": 256, "string": "(2017) propose a largescale, multi-task evaluation of sentence embeddings, focusing entirely on downstream tasks."}, {"id": 257, "string": "Conclusion We introduced a set of tasks probing the linguistic knowledge of sentence embedding methods."}, {"id": 258, "string": "Their purpose is not to encourage the development of ad-hoc models that attain top performance on them, but to help exploring what information is captured by different pre-trained encoders."}, {"id": 259, "string": "We performed an extensive linguistic evaluation of modern sentence encoders."}, {"id": 260, "string": "Our results suggest that the encoders are capturing a wide range of properties, well above those captured by a set of strong baselines."}, {"id": 261, "string": "We further uncovered interesting patterns of correlation between the probing tasks and more complex \"downstream\" tasks, and presented a set of intriguing findings about the linguistic properties of various embedding methods."}, {"id": 262, "string": "For example, we found that Bag-of-Vectors is surprisingly good at capturing sentence-level properties, thanks to redundancies in natural linguistic input."}, {"id": 263, "string": "We showed that different encoder architectures trained with the same objective with similar performance can result in different embeddings, pointing out the importance of the architecture prior for sentence embeddings."}, {"id": 264, "string": "In particular, we found that BiLSTM-max embeddings are already capturing interesting linguistic knowledge before training, and that, after training, they detect semantic acceptability without having been exposed to anomalous sentences before."}, {"id": 265, "string": "We hope that our publicly available probing task set will become a standard benchmarking tool of the linguistic properties of new encoders, and that it will stir research towards a better understanding of what they learn."}, {"id": 266, "string": "In future work, we would like to extend the probing tasks to other languages (which should be relatively easy, given that they are automatically generated), investigate how multi-task training affects probing task performance and leverage our probing tasks to find more linguistically-aware universal encoders."}], "headers": [{"section": "Introduction", "n": "1", "start": 0, "end": 22}, {"section": "Probing tasks", "n": "2", "start": 23, "end": 96}, {"section": "Sentence embedding models", "n": "3", "start": 97, "end": 99}, {"section": "Sentence encoder architectures", "n": "3.1", "start": 100, "end": 116}, {"section": "Training tasks", "n": "3.2", "start": 117, "end": 130}, {"section": "Training details", "n": "3.3", "start": 131, "end": 145}, {"section": "Probing task experiments", "n": "4", "start": 146, "end": 245}, {"section": "Related work", "n": "5", "start": 246, "end": 256}, {"section": "Conclusion", "n": "6", "start": 257, "end": 266}], "figures": [{"filename": "../figure/image/1007-Figure2-1.png", "caption": "Figure 2: Spearman correlation matrix between probing and downstream tasks. Correlations based on all sentence embeddings we investigated (more than 40). Cells in gray denote task pairs that are not significantly correlated (after correcting for multiple comparisons).", "page": 8, "bbox": {"x1": 72.0, "x2": 291.36, "y1": 61.44, "y2": 203.04}}, {"filename": "../figure/image/1007-Table1-1.png", "caption": "Table 1: Source and target examples for seq2seq training tasks.", "page": 4, "bbox": {"x1": 73.92, "x2": 524.16, "y1": 62.879999999999995, "y2": 236.16}}, {"filename": "../figure/image/1007-Figure1-1.png", "caption": "Figure 1: Probing task scores after each training epoch, for NMT and SkipThought. We also report training score evolution: BLEU for NMT; perplexity (PPL) for SkipThought.", "page": 7, "bbox": {"x1": 76.32, "x2": 288.96, "y1": 63.839999999999996, "y2": 278.4}}]}